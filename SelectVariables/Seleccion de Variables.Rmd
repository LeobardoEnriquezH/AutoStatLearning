---
title: "Selección de Variables"
author: "Saúl & Leobardo"
date: "2024-05-12"
output: pdf_document
---

```{r setup, include=FALSE}
rm(list = ls(all.names = TRUE))
gc()

knitr::opts_chunk$set(
	echo = FALSE,
	fig.align = "center",
	fig.dim = c(4.0, 3.0),
	fig.pos = "H",
	message = FALSE,
	warning = FALSE,
	error = F
)
```


```{r Librerias, include = FALSE}
#Librerias
library(ISLR)
library(dplyr)
library(tidyr)
library(forcats)
library(broom)
library(ggplot2)

## SelecciÃ³n de variables
library(leaps)
library(MASS)
library(bestglm)
library(glmnet)
library(faraway)
library(gridExtra)
library(stargazer)
```

Para este ejercicio lo que nos interesa es usar las variables clínicas observadas en pacientes para estudiar cuales son los factores que ayudan a modelar mejor el promedio del porcentaje de grasa corporal en Hombres.

```{r,echo=FALSE,message=FALSE,warning=FALSE}
#comenzamos cargando los datos que vamos a usar y los guardamos en una variable 
data <- faraway::fat
#ya que tenemos los datos vamos a eliminar las variables siri, density y free, ademas vamos a eliminar los valores "raros" de las variables height y weight, asi como valores cero en la variable brozek.
fat <- subset(data, select = -c(siri, density, free))
#graficos de boxplot para ver identificar outliers y eliminarlos 

par(mfrow = c(1, 2))
boxplot(fat$weight, # Datos
        horizontal = FALSE, # Horizontal o vertical
        lwd = 2, # Lines width
        col = rgb(1, 0, 0, alpha = 0.4), # Color
        xlab = "Weight",  # Etiqueta eje X
        ylab = "Values",  # Etiqueta eje Y
        main = "Boxplot Weight", # Título
        notch = TRUE, # Añade intervalos de confianza para la mediana
        border = "black",  # Color del borde del boxplot
        outpch = 25,       # Símbolo para los outliers
        outbg = "red",   # Color de los datos atípicos
        whiskcol = "blue", # Color de los bigotes
        whisklty = 2,      # Tipo de línea para los bigotes
        lty = 1)# Tipo de línea (caja y mediana)

#legend("topright", legend = "Weight", # Posición y título
    #fill = rgb(1, 0, 0, alpha = 0.4),  # Color
    #inset = c(0.03, 0.05), # Cambiamos los márgenes
    #bg = "white")

boxplot(fat$height, # Datos
        horizontal = FALSE, # Horizontal o vertical
        lwd = 2, # Lines width
        col = rgb(1, 0, 0, alpha = 0.4), # Color
        xlab = "Height",  # Etiqueta eje X
        ylab = "Values",  # Etiqueta eje Y
        main = "Boxplot Height", # Título
        notch = TRUE, # Añade intervalos de confianza para la mediana
        border = "black",  # Color del borde del boxplot
        outpch = 25,       # Símbolo para los outliers
        outbg = "red",   # Color de los datos atípicos
        whiskcol = "blue", # Color de los bigotes
        whisklty = 2,      # Tipo de línea para los bigotes
        lty = 1)


#legend("topright", legend = "Height", # Posición y título
    #fill = rgb(1, 0, 0, alpha = 0.4),  # Color
    #inset = c(0.03, 0.05), # Cambiamos los márgenes
    #bg = "white")
#de los boxplot tenemos identificados valores atipicos para la variable Weight por encima de 250 por lo que se quitaran esos valores, en el caso de la variable Height tenemos un valor por debajo de 60 por lo que tambien removeremos ese valor de las variables y de una vez se quitaran los ceros de la variable brozek

```


```{r,echo=FALSE,message=FALSE,warning=FALSE}

fat <- fat[fat$weight <= 250, ]
fat <- fat[fat$height >= 60, ]
fat <- fat[fat$brozek != 0, ]

par(mfrow = c(1, 2))
boxplot(fat$weight, # Datos
        horizontal = FALSE, # Horizontal o vertical
        lwd = 2, # Lines width
        col = rgb(1, 0, 0, alpha = 0.4), # Color
        xlab = "Weight",  # Etiqueta eje X
        ylab = "Values",  # Etiqueta eje Y
        main = "Boxplot Weight", # Título
        notch = TRUE, # Añade intervalos de confianza para la mediana
        border = "black",  # Color del borde del boxplot
        outpch = 25,       # Símbolo para los outliers
        outbg = "red",   # Color de los datos atípicos
        whiskcol = "blue", # Color de los bigotes
        whisklty = 2,      # Tipo de línea para los bigotes
        lty = 1)# Tipo de línea (caja y mediana)

#legend("topright", legend = "Weight", # Posición y título
    #fill = rgb(1, 0, 0, alpha = 0.4),  # Color
    #inset = c(0.03, 0.05), # Cambiamos los márgenes
    #bg = "white")

boxplot(fat$height, # Datos
        horizontal = FALSE, # Horizontal o vertical
        lwd = 2, # Lines width
        col = rgb(1, 0, 0, alpha = 0.4), # Color
        xlab = "Height",  # Etiqueta eje X
        ylab = "Values",  # Etiqueta eje Y
        main = "Boxplot Height", # Título
        notch = TRUE, # Añade intervalos de confianza para la mediana
        border = "black",  # Color del borde del boxplot
        outpch = 25,       # Símbolo para los outliers
        outbg = "red",   # Color de los datos atípicos
        whiskcol = "blue", # Color de los bigotes
        whisklty = 2,      # Tipo de línea para los bigotes
        lty = 1)


#legend("topright", legend = "Height", # Posición y título
    #fill = rgb(1, 0, 0, alpha = 0.4),  # Color
    #inset = c(0.03, 0.05), # Cambiamos los márgenes
    #bg = "white")

#ya no tenemos outliers en las variables.
```


Ya que se identificaron los outliers existentes en las variables de Height y Weight lo que se hizo fue eliminarlos, dicho procedimiento se observa en los boxplot realizados.

Con el pre procesamiento realizado lo que sigue es crear modelos para datos continuos con liga identidad y distribución Gaussiana,ademas de hacer selección de variables, etc.

```{r,echo=FALSE,message=FALSE,warning=FALSE}
#seleccion del subconjunto de variables
best_subset <- regsubsets(brozek ~ age + weight + height + adipos + neck
                                + chest + abdom + hip + thigh + knee + ankle +
                                  biceps + forearm + wrist, data = fat,
                                method = "exhaustive", nvmax = 14)
coef(best_subset, 3)

### Ajuste con las covariables que entran al modelo bajo la seleccion del mejor subconjunto
fitBestSubset <- lm(formula = brozek ~ height + abdom  + wrist, data = fat)
#summary(fitBestSubset)
BIC(fitBestSubset)
```

En este primer ajuste lo que se hizo fue hacer la selección de las mejores variables, es decir, las que aportan mas información al modelo y fueron height, abdom, wrist, de las cuales se obtuvo un BIC de 1412.142


```{r,echo=FALSE,message=FALSE,warning=FALSE}
#Ajuste de modelo stepwise
fit_forward <- regsubsets(brozek ~ .,data = fat,method = "forward",nvmax = 14)
#plot(fit_forward, scale = "bic")
coef(fit_forward, 3) #variables seleccionadas del metodo forward
modelo_forward <- lm(formula = brozek ~ weight + abdom + wrist,
                     data = fat)
#summary(modelo_forward)
BIC(modelo_forward)
```
Con el ajuste del modelo stepwise(forward) se obtuvo un BIC de 1412.255 el cual es muy parecido al obtenido con el del primer ajuste realizado con la seleccion de variables.

```{r,echo=FALSE,message=FALSE,warning=FALSE}
#ademas del ajuste forward que se hizo se mostrara el resultado de aplicar un metodo backward
fit_backward <- regsubsets(brozek ~ .,
                              data = fat,
                              method = "backward",
                              nvmax = 14)
#plot(fit_backward, scale = "bic")
#Obtenemos las variables con las que debemos trabajar 
coef(fit_backward, 3)

### Ajuste con las covariables que entran al modelo bajo la seleccion backward
modelo_backward <- lm(formula = brozek ~ age + abdom + wrist,
                      data = fat)
#summary(modelo_backward)

### ComparaciÃ³n de BIC.
BIC(modelo_backward)
```

Como resultado del ajuste Backward obtuvimos un BIC  de 1415.872 el cual comparado con los anteriores 2 BIC resulta mas alto.


```{r,echo=FALSE,message=FALSE,warning=FALSE}
#modelo con metodo lasso

# Creamos la matriz de diseño X y la variable de respuesta y
X <- model.matrix(object = brozek ~ ., data = fat)
Y <- fat$brozek

datos <- cbind(X, Y) #combinamos ambas variables en un conjunto de datos

bd <- as.data.frame(datos)

# Eliminamos el intercepto 
bd_int_less <- bd[, -1]

metodo_lasso <- glmnet(X,Y, family = gaussian(link = "identity"), nlambda = 100)

Lista_modelos <- list()
Lista_BIC <- list()
final <- length(metodo_lasso$lambda)
print(final)

for (i in 1:final) {
  coeficientes <- coef(metodo_lasso)[, i] != 0
  matriz_variables_X <- X[, coeficientes[-1]] # Excluir el intercepto
  
  # Ajustar el modelo con las variables seleccionadas por la penalizaciÃ³n Lasso
  ajuste_lasso <- glm(formula = Y ~ ., family = gaussian(link = "identity"), data = data.frame(matriz_variables_X, Y))
  
  Lista_modelos[[i]] <- ajuste_lasso
  Lista_BIC[[i]] <- BIC(ajuste_lasso)
}

# Se busca el indice del modelo con el minimo BIC, usamos la funcion unlist para deshacer la lista
min_bic_indice <- which.min(unlist(Lista_BIC))

# Se obtiene el modelo Ã³ptimo y sus coeficientes
modelo_seleccionado <- Lista_modelos[[min_bic_indice]]
coeficientes <- coefficients(modelo_seleccionado)

# Se imprimen los coeficientes del modelo Ã³ptimo y su BIC
print(coeficientes)

Ajuste_ModeloLasso <- lm(formula = brozek ~ age + height + abdom + wrist, data = fat)
  
  
print(BIC(modelo_seleccionado))
print(BIC(Ajuste_ModeloLasso))

#summary 
#summary(modelo_seleccionado)
#summary(Ajuste_ModeloLasso)
```

Con los métodos anteriormente realizados obtuvimos BIC muy similares entre si por lo que escoger uno como mejor modelo seria usar el mas parsimonioso, es decir, que resulte fácil de construirse y de interpretarse.

Ahora ajustaremos modelos parecidos a los anteriormente realizados con la diferencia de que incluiremos interacciones para ver si mejoran los modelos.


```{r,echo=FALSE,message=FALSE,warning=FALSE}

Metodo_backward_interacciones <- regsubsets(brozek ~ . ^2,
                              data = fat,
                              method = "backward",
                              nvmax = 14)

#Usando la siguiente grÃ¡fica encontramos 4 valores
#plot(Metodo_backward_interacciones, scale = "bic")

#Obtenemos las variables con las que debemos trabajar 
coef(Metodo_backward_interacciones, 4)

### Ajuste con las covariables que entran al modelo bajo la selecciÃ³n backward
Ajuste_backward2 <- lm(formula = brozek ~ hip + height:hip + neck:abdom + neck:hip,
                      data = fat)
#summary(Ajuste_backward2)

### ComparaciÃ³n de BIC.
BIC(Ajuste_backward2)
```


```{r,echo=FALSE,message=FALSE,warning=FALSE}

forward_interacciones <- regsubsets(brozek ~ . ^2,
                              data = fat,
                              method = "forward",
                              nvmax = 14)

#Usando la siguiente grÃ¡fica encontramos 4 valores
#plot(forward_interacciones, scale = "bic")

#Obtenemos las variables con las que debemos trabajar 
coef(forward_interacciones, 3)

### Ajuste con las covariables que entran al modelo bajo la selecciÃ³n backward
Ajuste_forward2 <- lm(formula = brozek ~ abdom + height:wrist + chest:hip,
                      data = fat)
#summary(Ajuste_forward2)

### ComparaciÃ³n de BIC.
BIC(Ajuste_forward2)
```


```{r,echo=FALSE,message=FALSE,warning=FALSE}

#Matriz diseño considerando interacciones 
X2 <- model.matrix(object = brozek ~ .^2, data = fat)

#Le quitamos el intercepto 
X2_aux <- X2[,-1]


#Variable y 
y <- fat$brozek

#Realizamos la penalizacion lasso 
lasso_inter <- glmnet(X2_aux, y, family <- gaussian(link = "identity"), nlambda = 100)

#Para eso, los coeficientes los vamos a utilizar, y buscaremos los 
#coeficientes que no son 0 en cada iteraciÃ³n, y lo haremos un dataframe
coeficientes2 <- data.frame(t(as.matrix(coef(lasso_inter)!=0)))

#Como podemos tener una gran cantidad de valores repetidos con esto, 
#vamos a aplica la funciÃ³n unique, que nos ayudarÃ¡ a eliminar valores repetidos
coeficientes2 <- unique(coeficientes2)


#Con esto, vamos a obtener la combinaciÃ³n que tiene el menor BIC
BIC_lasso_comp<-sapply(1:length(coeficientes2$X.Intercept.), function(x){
  BIC(glm(formula = y ~ X2[,unlist(coeficientes2[x,])] - 1, family = gaussian))}) 

#Utilizamos la segunda forma porque la primera tiene algunas complicaciones
best_lasso_comp2 <- glm(formula = y ~ X2_aux[,unlist(coeficientes2[which.min(BIC_lasso_comp),c(-1)])], family = gaussian)
print(coef(best_lasso_comp2))


AjusteLasso_Interacciones <- glm(formula = brozek ~ abdom + age:abdom + age:thigh + height:wrist, data = fat)


#Verificamos el BIC 
#summary(BIC_lasso_comp)
#summary(best_lasso_comp2)
#summary(AjusteLasso_Interacciones)
BIC(best_lasso_comp2)
print(BIC(AjusteLasso_Interacciones))
```

Con los nuevos cambios en el modelo lasso con interacciones obtuvimos un BIC de 1411.985 por lo que notamos una pequeña mejoría respecto a los ajustes de modelos aplicados en la primer parte.

Agregaremos ajustes nuevos probando con distintas funciones ligas con el fin de ver si con esto logramos mejorar el puntaje de BIC obtenidos hasta este momento.

```{r,echo=FALSE,message=FALSE,warning=FALSE}
modelo_gamma_x <- glm(formula = brozek ~ height + abdom  + wrist,
                              family = Gamma(link = "identity"), data = fat)

modelo_gamma_log <- glm(formula = brozek ~ height + abdom  + wrist,
                              family = Gamma(link = "log"), data = fat)


#Metodo stepwise con backward
modelo_gamma_x2 <- glm(formula = brozek ~ weight + abdom + wrist, family = Gamma(link = "identity"), data = fat)

modelo_gamma_log2 <- glm(formula = brozek ~ weight + abdom + wrist, family = Gamma(link = "log"), data = fat)

#Forward
modelo_gamma_x3 <- glm(formula = brozek ~ abdom + height + abdom + wrist, family = Gamma(link = "identity"), data = fat)

modelo_gamma_log3 <- glm(formula = brozek ~ abdom + height + abdom + wrist, family = Gamma(link = "log"), data = fat)

#Segundo inciso tomando las mejoras
#Backward
modelo_gamma_x4 <- glm(formula = brozek ~ hip + height:hip + neck:abdom + neck:hip, family = Gamma(link = "identity"), data = fat)

modelo_gamma_log4 <- glm(formula = brozek ~ hip + height:hip + neck:abdom + neck:hip, family = Gamma(link = "log"), data = fat)

#Forward 
modelo_gamma_x5 <- glm(formula = brozek ~ abdom + height:wrist + chest:hip, family = Gamma(link = "identity"), data = fat)

modelo_gamma_log5 <- glm(formula = brozek ~ abdom + height:wrist + chest:hip, family = Gamma(link = "log"), data = fat)

#Lasso 
modelo_gamma_x6 <- glm(formula = brozek ~ abdom + age:abdom + age:thigh + height:wrist, family = Gamma(link = "identity"), data = fat)

modelo_gamma_log6 <- glm(formula = brozek ~ abdom + age:abdom + age:thigh  + height:wrist, family = Gamma(link = "log"), data = fat)

#BIC's
print(BIC(modelo_gamma_x))
print(BIC(modelo_gamma_log))
print(BIC(modelo_gamma_x2))
print(BIC(modelo_gamma_log2))
print(BIC(modelo_gamma_x3))
print(BIC(modelo_gamma_log3))
print(BIC(modelo_gamma_x4))
print(BIC(modelo_gamma_log4))
print(BIC(modelo_gamma_x5))
print(BIC(modelo_gamma_log5))
print(BIC(modelo_gamma_x6))
print(BIC(modelo_gamma_log6))

#Mejor modelo segun el criterio del BIC
Lista_bic_modelos <- c(BIC(modelo_gamma_x), BIC(modelo_gamma_log), BIC(modelo_gamma_x2), BIC(modelo_gamma_log2), BIC(modelo_gamma_x3), BIC(modelo_gamma_log3), BIC(modelo_gamma_x4), BIC(modelo_gamma_log4), BIC(modelo_gamma_x5), BIC(modelo_gamma_log5), BIC(modelo_gamma_x6), BIC(modelo_gamma_log6))

Lista_modelos <- c(modelo_gamma_x, modelo_gamma_log, modelo_gamma_x2, modelo_gamma_log2, modelo_gamma_x3, modelo_gamma_log3, modelo_gamma_x4, modelo_gamma_log4, modelo_gamma_x5, modelo_gamma_log5, modelo_gamma_x6, modelo_gamma_log6)

min_index <- which.min(Lista_bic_modelos)
print(min_index) #con esto obtenemos el mejor modelo seleccionado a partir del criterio del BIC 
menor_bic <- Lista_bic_modelos[[min_index]] #extraemos el valor del BIC y lo guardamos en una variable nueva
print(menor_bic)
coef(modelo_gamma_log4)#obtenemos los coeficientes que componen el mejor modelo 


```



```{r,echo=FALSE,message=FALSE,warning=FALSE}
#En este apartado lo que se busca es hacer un proceso similar al anterior generando modelo con la diferencia de que ahora se tomara el cuadrado de las variables

#MÃ©todo mejor subconjunto
ajusteCuadratico_subset <- lm(formula = brozek ~ height + I(height^2) + abdom + I(abdom^2) + wrist + I(wrist^2),data = fat)

#Metodo stepwise(Forward)
ajusteCuadratico1 <- lm(formula = brozek ~ weight + I(weight^2) + abdom + I(abdom^2) + wrist + I(wrist^2),
                       data = fat)

#Backward
ajusteCuadratico2 <- lm(formula = brozek ~ age + I(age^2) + abdom + I(abdom^2) + wrist + I(wrist^2),data = fat)

#Lasso 
ajusteCuadratico_Lasso <- lm(formula = brozek ~ age + I(age^2) + height + I(height^2) + abdom + I(abdom^2) + wrist + I(wrist^2), data = fat)

#Metodo Stepwise(Backward)
ajusteCuadraticox4 <- glm(formula = brozek ~ weight + I(weight^2) + abdom + I(abdom^2) + wrist + I(wrist^2),family = Gamma(link = "identity"), data = fat)

ajusteCuadraticoLog4 <- glm(formula = brozek ~ weight + I(weight^2) + abdom + I(abdom^2) + wrist + I(wrist^2),family = Gamma(link = "log"), data = fat)

#Forward 
ajusteCuadraticox5 <- glm(formula = brozek ~ abdom + I(abdom^2) + height:wrist + I(height^2):I(wrist^2) + chest:hip + I(chest^2):I(hip^2),family = Gamma(link = "identity"), data = fat)

ajusteCuadraticoLog5 <- glm(formula = brozek ~ abdom + I(abdom^2) + height:wrist + I(height^2):wrist + chest:hip + I(chest^2):hip,family = Gamma(link = "log"), data = fat)

#Lasso 
ajusteCuadraticox6 <- glm(formula = brozek ~ abdom + I(abdom^2) + age:abdom + I(age^2):abdom + age:thigh + I(age^2):thigh + height:wrist + I(height^2):wrist,family = Gamma(link = "identity"), data = fat)

ajusteCuadraticoLog6 <- glm(formula = brozek ~ abdom + I(abdom^2) + age:abdom + I(age^2):abdom + age:thigh + I(age^2):thigh + height:wrist + I(height^2):wrist,family = Gamma(link = "log"), data = fat)

print(BIC(ajusteCuadratico1))
print(BIC(ajusteCuadratico2))
print(BIC(ajusteCuadratico_Lasso))
print(BIC(ajusteCuadraticox4))
print(BIC(ajusteCuadraticoLog4))
print(BIC(ajusteCuadraticox5))
print(BIC(ajusteCuadraticoLog5))
print(BIC(ajusteCuadraticox6))
print(BIC(ajusteCuadraticoLog6))

#Mejor modelo 
Lista_bic_modelos_al_cuadrado <- c(BIC(ajusteCuadratico_subset), BIC(ajusteCuadratico1), BIC(ajusteCuadratico2), BIC(ajusteCuadratico_Lasso), BIC(ajusteCuadraticox4), BIC(ajusteCuadraticoLog4), BIC(ajusteCuadraticox5), BIC(ajusteCuadraticoLog5), BIC(ajusteCuadraticox6), BIC(ajusteCuadraticoLog6))

Lista_modelos_variables_al_cuadrado <- c(ajusteCuadratico_subset, ajusteCuadratico1, ajusteCuadratico2, ajusteCuadratico_Lasso, ajusteCuadraticox4, ajusteCuadraticoLog4, ajusteCuadraticox5, ajusteCuadraticoLog5, ajusteCuadraticox6, ajusteCuadraticoLog6)

min_index_sqr <- which.min(Lista_bic_modelos_al_cuadrado)
print(min_index_sqr)
menor_bic_cuadrado <- Lista_bic_modelos_al_cuadrado[[min_index_sqr]]
print(menor_bic_cuadrado)
coef(ajusteCuadratico_subset)
```

De todos los modelos generados con las modificaciones y tomando el cuadrado de las variables tenemos que el mejor modelo escogido a partir del criterio BIC fue el que toma el mejor subconjunto de variables tomando su cuadrado con un BIC  de 1423.089.

\newpage


\begin{table}[h]
  \centering
  \footnotesize
  \begin{tabular}{|l|c|l|}
    \hline
    No. de Modelo & Método de selección de variables & BIC \\
    \hline
    1 & fitBestSubset & 1412.142 \\
    2 & modeloforward & 1412.255 \\
    3 & modelobackward & 1415.872 \\
    4 & AjusteModeloLasso & 1413.107  \\
    5 & Ajusteforward2 & 1405.596   \\
    6 & Ajustebackward2 & 1416.311   \\
    7 & AjusteLassoInteracciones & 1411.985   \\
    8 & Backward, distribución Gamma, liga identidad & 1490.06  \\
    9 & ajusteCuadraticosubset & 1423.089  \\
    \hline
  \end{tabular}
  \caption{Resultados de los métodos de selección}
  \label{tabla:resultados}
\end{table}



  De acuerdo a los modelos que se observan en la tabla, la variable que mas veces aparece es \textit{abdom}, la cual aparece un total de 6 veces, sin contar aquellos modelos en los que se toman las interacciones, seguida de la variable \textit{wrist}, la cual aparece 4 veces, tambien sin contar interacciones. Además los coeficientes asociados a la variable abdom son positivos en los primeros cuatro modelos por lo que podemos afirmar que la variable más significativa asociada a un incremento del valor promedio de la grasa corporal en los hombres es la medida del abdomen \textsuperscript{\textbf{[2]}}. En cambio, en los primeros cuatro modelos de la tabla que incluyen a la variable wrist los coeficientes asociados a la variable wrist son negativos en los modelos en que esta variable aparece y por lo tanto es posible inferir que a medida que la medición de la muñeca aumenta entonces habra una disminución del valor promedio de la grasa corporal en hombres \textsuperscript{\textbf{[3]}}. En conclusión las variables más significativas para modelar el promedio de la grasa corporal en los hombres son la medida del abdomen y de la muñeca. Las variables que no aparecen entre las seleccionadas son: adipos, knee, ankle, biceps, forearm. Por lo tanto ninguna de las variables anteriormente mencionadas tiene algún efecto sobre el valor promedio del porcentaje de grasa en hombres.

Además, según el criterio BIC, se observa que al considerar modelos que toman en cuenta las interacciones entre las variables, el BIC de los modelos con interacciones disminuye. Esto indica que, al incorporar interacciones, el modelo del promedio de porcentaje de grasa corporal en hombres se ajusta mejor a los datos.

Por otra parte, de los modelos observados en el \textbf{Cuadro 1} se puede ver que aquel que tiene un menor valor BIC es el modelo cuya selección de variables se realizo con el método stepwise conocido como \textit{Forward} incluyendo interacciones. Los coeficientes de esto modelo pueden ser interpretados de la siguiente manera: Un aumento del 100% de la variable \textit{hip} se asocia a un aumento del 114 \% en el promedio de la grasa corporal de los hombres dejando al resto de variables fijas, a su vez las variables asociadas a la altura y a la medida del cuello (\textit{height} y \textit{neck}) interactuan con la variable \textit{hip}, que representa la medida de la cadera, el valor del coeficiente asociado es negativo, en particular, un aumento de una unidad para la variable asociada a la interacción \textit{hip:height} se asocia a una disminución del 0.4 \%  del promedio de la grasa corporal en hombres y un aumento en una unidad a la variable asociada a la interacción \textit{hip:neck} está asociada a una disminución del 2 \%  para el promedio de la grasa corporal en hombres, por otro lado la interacción \textit{neck:abdom} está asociada a un aumento del 2\% en el promedio de la grasa corporal para hombres. \textsuperscript{\textbf{[5]}}.


