modelo_glm1<-glm(formula = bpsystol ~ age+sex+bmi, family = inverse.gaussian(link = identity), data = datos)
#summary(modelo_glm1)
#stargazer(ModMinAIC, modelo_glm1)
K=matrix(c(0,1,0,0,
0,0,1,0,
0,0,0,1), ncol=4, nrow=3, byrow=TRUE)
m=c(0,0,0)
summary(glht(modelo_glm1, linfct=K, rhs=m), test=Chisqtest())
# Se incluye cierta aleatorización para datos binarios
library(statmod)
fitlogitqr <- qresid(modelo_glm1)
#qqnorm( fitlogitqr, las=1 ); qqline( fitlogitqr)
lilKS<-nortest::lillie.test(fitlogitqr)
Shapiro<-shapiro.test(fitlogitqr)
resid_panel(modelo_glm1, plots=c("all"),scale = 1)
set.seed(123)
fit2res <- simulateResiduals(fittedModel = modelo_glm1)
plot(fit2res)
K=matrix(c(0,0,0,1), ncol=4, nrow=1, byrow=TRUE)
m=0
prueba<-glht(modelo_glm1, linfct=K, rhs=m, alternative="greater")
#summary(prueba)
curva_ajustada_mujer30 <- function(x) {modelo_glm1$coefficients[1] + modelo_glm1$coefficients[4]*x + modelo_glm1$coefficients[3] + modelo_glm1$coefficients[2]*30}
curva_ajustada_hombre30 <- function(x) {modelo_glm1$coefficients[1] + modelo_glm1$coefficients[4]*x  + modelo_glm1$coefficients[2]*30}
curva_ajustada_mujer50 <- function(x) {modelo_glm1$coefficients[1] + modelo_glm1$coefficients[4]*x + modelo_glm1$coefficients[3] + modelo_glm1$coefficients[2]*50}
curva_ajustada_hombre50 <- function(x) {modelo_glm1$coefficients[1] + modelo_glm1$coefficients[4]*x  + modelo_glm1$coefficients[2]*50}
curva_ajustada_mujer64 <- function(x) {modelo_glm1$coefficients[1] + modelo_glm1$coefficients[4]*x + modelo_glm1$coefficients[3] + modelo_glm1$coefficients[2]*64}
curva_ajustada_hombre64 <- function(x) {modelo_glm1$coefficients[1] + modelo_glm1$coefficients[4]*x  + modelo_glm1$coefficients[2]*64}
ggplot(datos, aes(bmi, bpsystol)) +
geom_point() +
geom_function(fun = curva_ajustada_mujer30, aes(linetype = "mujer de 30") ,col="skyblue", lwd = 1) +
geom_function(fun = curva_ajustada_hombre30, aes(linetype = "hombre de 30") ,col="green") +
geom_function(fun = curva_ajustada_mujer50, aes(linetype = "mujer de 50") ,col="darkblue", lwd = 0.8) +
geom_function(fun = curva_ajustada_hombre50, aes(linetype = "hombre de 50") ,col="darkgreen") +
geom_function(fun = curva_ajustada_mujer64, aes(linetype = "mujer de 64") ,col="red") +
geom_function(fun = curva_ajustada_hombre64, aes(linetype = "hombre de 64") ,col="magenta") + theme_bw()
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(stargazer)
library(kableExtra)
library(flextable)
library(performance)
library(see)
library(lmtest)
library(qqplotr)
library(ggrepel)
library(patchwork)
library(boot)
library(rempsyc)
library(report)
library(multcomp)
library(ggplot2)
library(ggResidpanel)
library(DHARMa)
library(SuppDists)
datos<-read_csv("Preg1B.csv", show_col_types = FALSE)
datos$sex<-factor(datos$sex) #declaramos la variable como factor
#Realizamos un relevel para poner como referencia "1" hombre
datos$sex<-relevel(datos$sex,"1")
#Seleccionar un modelo entre un conjunto de posibles glm, mediante mallas
#Comp lineal: a)transf BoxTidwell(potencias) a x y b) polinomio sobre x
#Mallas para el valor de potencia y grado de polinomio:
malla=seq(from = 1, to = 5, by = 1)
Poli <- cbind("poly", malla)
malla=seq(from = -3, to = 3, by = .5)
Pot <- cbind("pot", malla)
CompLin=rbind(Poli, Pot)
#Componente aleatorio: Y es continua y positiva, tenemos tres opciones:
#Malla con distribucion Normal, Gausiana e Inversa Gausiana
Distribuciones=c("gaussian", "Gamma", "inverse.gaussian")
#Funcion liga:inverse, identity, log, y 1/mu^2(solo para IG)
FunLigas=c("identity", "log", "inverse", "1/mu^2")
#Declaramos longitud o dimensión de los vectores
nFunLigas=length(FunLigas)
nDist=length(Distribuciones)
nCompLin=dim(CompLin)[1]
#Creación de variables para guardar resultados
ModelList=list(NA)  #guardar resultados del ajuste, objeto glm
AICList=list(NA)    #guardar el AIC del modelo
BICList=list(NA)    #guardar el BIC del modelo
FormList=list(NA)   #guardar la formula usada para el ajuste
#Modelos 18*2*3+18*1*4(tres funciones ligas para 2 distrib y 4 para una, IG)
#Generamos los cíclos y combinaciones de las mallas
index=0
for(k in 1:nCompLin){
#definimos componente lineal y formula
if(CompLin[k,1]=="poly"){
formstring=paste0("bpsystol ~ age+sex+poly(bmi,",  CompLin[k,2], ", raw=TRUE)")
}else{
if(CompLin[k,2]==0){
formstring=paste0("bpsystol ~ age+sex+I(log(bmi))")}else
{
formstring=paste0("bpsystol ~ age+sex+I(bmi^(",  CompLin[k,2], "))")}
}
form <- as.formula(formstring)
for(j in 1:nDist){
for(l in 1:nFunLigas){
#definicion del argumento family
if(FunLigas[l]=="1/mu^2"){
if(Distribuciones[j]=="inverse.gaussian"){
index=index+1
Dist=get(Distribuciones[j])  #obtener la funcion a usar
Mod.A.Prueba=glm(form, data=datos, family = Dist(link=FunLigas[l]))
ModelList[[index]]=Mod.A.Prueba
AICList[[index]]=AIC(Mod.A.Prueba)
BICList[[index]]=BIC(Mod.A.Prueba)
FormList[[index]]=formstring
}
}else{
index=index+1
Dist=get(Distribuciones[j])
Mod.A.Prueba=glm(form, data=datos, family = Dist(link=FunLigas[l]))
ModelList[[index]]=Mod.A.Prueba
AICList[[index]]=AIC(Mod.A.Prueba)
BICList[[index]]=BIC(Mod.A.Prueba)
FormList[[index]]=formstring
}
}
}
}
#El modelo con menor AIC
MinAIC=which.min(unlist(AICList))
ModMinAIC=ModelList[[MinAIC]]
#summary(ModMinAIC)
#Mostrar los AIC, BIC, modelo y liga
ModMinAIC$family
AICList[[MinAIC]]
BICList[[MinAIC]]
FormList[[MinAIC]]
modelo_glm1<-glm(formula = bpsystol ~ age+sex+bmi, family = inverse.gaussian(link = identity), data = datos)
#summary(modelo_glm1)
#stargazer(ModMinAIC, modelo_glm1)
K=matrix(c(0,1,0,0,
0,0,1,0,
0,0,0,1), ncol=4, nrow=3, byrow=TRUE)
m=c(0,0,0)
summary(glht(modelo_glm1, linfct=K, rhs=m), test=Chisqtest())
# Se incluye cierta aleatorización para datos binarios
library(statmod)
fitlogitqr <- qresid(modelo_glm1)
#qqnorm( fitlogitqr, las=1 ); qqline( fitlogitqr)
lilKS<-nortest::lillie.test(fitlogitqr)
Shapiro<-shapiro.test(fitlogitqr)
resid_panel(modelo_glm1, plots=c("all"),scale = 1)
set.seed(123)
fit2res <- simulateResiduals(fittedModel = modelo_glm1)
plot(fit2res)
K=matrix(c(0,0,0,1), ncol=4, nrow=1, byrow=TRUE)
m=0
prueba<-glht(modelo_glm1, linfct=K, rhs=m, alternative="greater")
#summary(prueba)
curva_ajustada_mujer30 <- function(x) {modelo_glm1$coefficients[1] + modelo_glm1$coefficients[4]*x + modelo_glm1$coefficients[3] + modelo_glm1$coefficients[2]*30}
curva_ajustada_hombre30 <- function(x) {modelo_glm1$coefficients[1] + modelo_glm1$coefficients[4]*x  + modelo_glm1$coefficients[2]*30}
curva_ajustada_mujer50 <- function(x) {modelo_glm1$coefficients[1] + modelo_glm1$coefficients[4]*x + modelo_glm1$coefficients[3] + modelo_glm1$coefficients[2]*50}
curva_ajustada_hombre50 <- function(x) {modelo_glm1$coefficients[1] + modelo_glm1$coefficients[4]*x  + modelo_glm1$coefficients[2]*50}
curva_ajustada_mujer64 <- function(x) {modelo_glm1$coefficients[1] + modelo_glm1$coefficients[4]*x + modelo_glm1$coefficients[3] + modelo_glm1$coefficients[2]*64}
curva_ajustada_hombre64 <- function(x) {modelo_glm1$coefficients[1] + modelo_glm1$coefficients[4]*x  + modelo_glm1$coefficients[2]*64}
ggplot(datos, aes(bmi, bpsystol)) +
geom_point() +
geom_function(fun = curva_ajustada_mujer30, aes(linetype = "mujer de 30") ,col="skyblue", lwd = 1) +
geom_function(fun = curva_ajustada_hombre30, aes(linetype = "hombre de 30") ,col="green") +
geom_function(fun = curva_ajustada_mujer50, aes(linetype = "mujer de 50") ,col="darkblue", lwd = 0.8) +
geom_function(fun = curva_ajustada_hombre50, aes(linetype = "hombre de 50") ,col="darkgreen") +
geom_function(fun = curva_ajustada_mujer64, aes(linetype = "mujer de 64") ,col="red") +
geom_function(fun = curva_ajustada_hombre64, aes(linetype = "hombre de 64") ,col="magenta") + theme_bw()
knitr::opts_chunk$set(echo = T, fig.width = 6, fig.height = 2.9)
library(tidyverse)
library(kableExtra)
library(ggplot2)
library(cowplot)
library(stargazer)
library(knitr)
library(dplyr)
library(readr)
library(car)
library(multcomp)
library(MASS)
data1 <- read_csv("Preg1B.csv")
plot(data1$bmi,data1$bpsystol, xlab = "BMI", ylab = "Presión sistolica", col = "green4")
data1$sex <- as.factor(data1$sex)
glm_fit = glm(bpsystol ~ bmi + sex + age, data = data1, family = inverse.gaussian(link = "identity"))
summary(glm_fit)
K=matrix(c(0,1,0,0,
0,0,1,0,
0,0,0,1), ncol=4, nrow=3, byrow=TRUE)
m=c(0,0,0)
summary(glht(glm_fit, linfct=K, rhs=m), test=Chisqtest())
pchisq(glm_fit$deviance, df=glm_fit$df.residual, lower.tail=FALSE)
library(ggplot2)
library(ggResidpanel)
library(DHARMa)
library(SuppDists)
resid_panel(glm_fit, plots=c("all"),scale = 1)
set.seed(123)
fit2res <- simulateResiduals(fittedModel = glm_fit)
plot(fit2res)
par(mfrow = c(2, 2))
K=matrix(c(0,1), ncol=4, nrow=3, byrow=TRUE)
m=c(0)
summary(glht(glm_fit, linfct=K, rhs=m, alternative="greater"))
curva_ajustada_mujer30 <- function(x) {glm_fit$coefficients[1] + glm_fit$coefficients[2]*x + glm_fit$coefficients[3] + glm_fit$coefficients[4]*30}
curva_ajustada_hombre30 <- function(x) {glm_fit$coefficients[1] + glm_fit$coefficients[2]*x  + glm_fit$coefficients[4]*30}
curva_ajustada_mujer50 <- function(x) {glm_fit$coefficients[1] + glm_fit$coefficients[2]*x + glm_fit$coefficients[3] + glm_fit$coefficients[4]*50}
curva_ajustada_hombre50 <- function(x) {glm_fit$coefficients[1] + glm_fit$coefficients[2]*x  + glm_fit$coefficients[4]*50}
curva_ajustada_mujer64 <- function(x) {glm_fit$coefficients[1] + glm_fit$coefficients[2]*x + glm_fit$coefficients[3] + glm_fit$coefficients[4]*64}
curva_ajustada_hombre64 <- function(x) {glm_fit$coefficients[1] + glm_fit$coefficients[2]*x  + glm_fit$coefficients[4]*64}
ggplot(data1, aes(bmi, bpsystol)) +
geom_point() +
geom_function(fun = curva_ajustada_mujer30, aes(linetype = "mujer de 30") ,col="skyblue", lwd = 1) +
geom_function(fun = curva_ajustada_hombre30, aes(linetype = "hombre de 30") ,col="green") +
geom_function(fun = curva_ajustada_mujer50, aes(linetype = "mujer de 50") ,col="darkblue", lwd = 0.8) +
geom_function(fun = curva_ajustada_hombre50, aes(linetype = "hombre de 50") ,col="darkgreen") +
geom_function(fun = curva_ajustada_mujer64, aes(linetype = "mujer de 64") ,col="red") +
geom_function(fun = curva_ajustada_hombre64, aes(linetype = "hombre de 64") ,col="magenta") + theme_bw()
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(stargazer)
library(kableExtra)
library(flextable)
library(performance)
library(see)
library(lmtest)
library(qqplotr)
library(ggrepel)
library(patchwork)
library(boot)
library(rempsyc)
library(report)
library(multcomp)
library(ggplot2)
library(ggResidpanel)
library(DHARMa)
library(SuppDists)
datos<-read_csv("Preg1B.csv", show_col_types = FALSE)
datos$sex<-factor(datos$sex) #declaramos la variable como factor
#Realizamos un relevel para poner como referencia "1" hombre
datos$sex<-relevel(datos$sex,"1")
#Seleccionar un modelo entre un conjunto de posibles glm, mediante mallas
#Comp lineal: a)transf BoxTidwell(potencias) a x y b) polinomio sobre x
#Mallas para el valor de potencia y grado de polinomio:
malla=seq(from = 1, to = 5, by = 1)
Poli <- cbind("poly", malla)
malla=seq(from = -3, to = 3, by = .5)
Pot <- cbind("pot", malla)
CompLin=rbind(Poli, Pot)
#Componente aleatorio: Y es continua y positiva, tenemos tres opciones:
#Malla con distribucion Normal, Gausiana e Inversa Gausiana
Distribuciones=c("gaussian", "Gamma", "inverse.gaussian")
#Funcion liga:inverse, identity, log, y 1/mu^2(solo para IG)
FunLigas=c("identity", "log", "inverse", "1/mu^2")
#Declaramos longitud o dimensión de los vectores
nFunLigas=length(FunLigas)
nDist=length(Distribuciones)
nCompLin=dim(CompLin)[1]
#Creación de variables para guardar resultados
ModelList=list(NA)  #guardar resultados del ajuste, objeto glm
AICList=list(NA)    #guardar el AIC del modelo
BICList=list(NA)    #guardar el BIC del modelo
FormList=list(NA)   #guardar la formula usada para el ajuste
#Modelos 18*2*3+18*1*4(tres funciones ligas para 2 distrib y 4 para una, IG)
#Generamos los cíclos y combinaciones de las mallas
index=0
for(k in 1:nCompLin){
#definimos componente lineal y formula
if(CompLin[k,1]=="poly"){
formstring=paste0("bpsystol ~ age+sex+poly(bmi,",  CompLin[k,2], ", raw=TRUE)")
}else{
if(CompLin[k,2]==0){
formstring=paste0("bpsystol ~ age+sex+I(log(bmi))")}else
{
formstring=paste0("bpsystol ~ age+sex+I(bmi^(",  CompLin[k,2], "))")}
}
form <- as.formula(formstring)
for(j in 1:nDist){
for(l in 1:nFunLigas){
#definicion del argumento family
if(FunLigas[l]=="1/mu^2"){
if(Distribuciones[j]=="inverse.gaussian"){
index=index+1
Dist=get(Distribuciones[j])  #obtener la funcion a usar
Mod.A.Prueba=glm(form, data=datos, family = Dist(link=FunLigas[l]))
ModelList[[index]]=Mod.A.Prueba
AICList[[index]]=AIC(Mod.A.Prueba)
BICList[[index]]=BIC(Mod.A.Prueba)
FormList[[index]]=formstring
}
}else{
index=index+1
Dist=get(Distribuciones[j])
Mod.A.Prueba=glm(form, data=datos, family = Dist(link=FunLigas[l]))
ModelList[[index]]=Mod.A.Prueba
AICList[[index]]=AIC(Mod.A.Prueba)
BICList[[index]]=BIC(Mod.A.Prueba)
FormList[[index]]=formstring
}
}
}
}
#El modelo con menor AIC
MinAIC=which.min(unlist(AICList))
ModMinAIC=ModelList[[MinAIC]]
#summary(ModMinAIC)
#Mostrar los AIC, BIC, modelo y liga
ModMinAIC$family
AICList[[MinAIC]]
BICList[[MinAIC]]
FormList[[MinAIC]]
modelo_glm1<-glm(formula = bpsystol ~ age+sex+bmi, family = inverse.gaussian(link = identity), data = datos)
#summary(modelo_glm1)
#stargazer(ModMinAIC, modelo_glm1)
K=matrix(c(0,1,0,0,
0,0,1,0,
0,0,0,1), ncol=4, nrow=3, byrow=TRUE)
m=c(0,0,0)
summary(glht(modelo_glm1, linfct=K, rhs=m), test=Chisqtest())
# Se incluye cierta aleatorización para datos binarios
library(statmod)
fitlogitqr <- qresid(modelo_glm1)
#qqnorm( fitlogitqr, las=1 ); qqline( fitlogitqr)
lilKS<-nortest::lillie.test(fitlogitqr)
Shapiro<-shapiro.test(fitlogitqr)
resid_panel(modelo_glm1, plots=c("all"),scale = 1)
set.seed(123)
fit2res <- simulateResiduals(fittedModel = modelo_glm1)
plot(fit2res)
K=matrix(c(0,0,0,1), ncol=4, nrow=1, byrow=TRUE)
m=0
prueba<-glht(modelo_glm1, linfct=K, rhs=m, alternative="greater")
#summary(prueba)
curva_ajustada_mujer30 <- function(x) {modelo_glm1$coefficients[1] + modelo_glm1$coefficients[4]*x + modelo_glm1$coefficients[3] + modelo_glm1$coefficients[2]*30}
curva_ajustada_hombre30 <- function(x) {modelo_glm1$coefficients[1] + modelo_glm1$coefficients[4]*x  + modelo_glm1$coefficients[2]*30}
curva_ajustada_mujer50 <- function(x) {modelo_glm1$coefficients[1] + modelo_glm1$coefficients[4]*x + modelo_glm1$coefficients[3] + modelo_glm1$coefficients[2]*50}
curva_ajustada_hombre50 <- function(x) {modelo_glm1$coefficients[1] + modelo_glm1$coefficients[4]*x  + modelo_glm1$coefficients[2]*50}
curva_ajustada_mujer64 <- function(x) {modelo_glm1$coefficients[1] + modelo_glm1$coefficients[4]*x + modelo_glm1$coefficients[3] + modelo_glm1$coefficients[2]*64}
curva_ajustada_hombre64 <- function(x) {modelo_glm1$coefficients[1] + modelo_glm1$coefficients[4]*x  + modelo_glm1$coefficients[2]*64}
ggplot(datos, aes(bmi, bpsystol)) +
geom_point() +
geom_function(fun = curva_ajustada_mujer30, aes(linetype = "mujer de 30") ,col="skyblue", lwd = 1) +
geom_function(fun = curva_ajustada_hombre30, aes(linetype = "hombre de 30") ,col="green") +
geom_function(fun = curva_ajustada_mujer50, aes(linetype = "mujer de 50") ,col="darkblue", lwd = 0.8) +
geom_function(fun = curva_ajustada_hombre50, aes(linetype = "hombre de 50") ,col="darkgreen") +
geom_function(fun = curva_ajustada_mujer64, aes(linetype = "mujer de 64") ,col="red") +
geom_function(fun = curva_ajustada_hombre64, aes(linetype = "hombre de 64") ,col="magenta") + theme_bw()
#Modelo Reg Lineal con logaritmos
modelo2=lm(data=datos, I(log(bpsystol)) ~ bmi + sex + age)
summary(modelo2)
#Modelo Reg Lineal con logaritmos
modelo2=lm(data=datos, I(log(bpsystol)) ~ bmi + sex + age)
summary(modelo2)
summary(modelo_glm1)
#Modelo Reg Lineal con logaritmos
modelo2=lm(data=datos, I(log(bpsystol)) ~ bmi + sex + age)
summary(modelo2)
summary(modelo_glm1)
stargazer(modelo2, modelo_glm1)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(stargazer)
library(kableExtra)
library(flextable)
library(performance)
library(see)
library(lmtest)
library(qqplotr)
library(ggrepel)
library(patchwork)
library(boot)
library(rempsyc)
library(report)
library(multcomp)
library(ggplot2)
library(ggResidpanel)
library(DHARMa)
library(SuppDists)
datos<-read_csv("Preg1B.csv", show_col_types = FALSE)
datos$sex<-factor(datos$sex) #declaramos la variable como factor
#Realizamos un relevel para poner como referencia "1" hombre
datos$sex<-relevel(datos$sex,"1")
#Seleccionar un modelo entre un conjunto de posibles glm, mediante mallas
#Comp lineal: a)transf BoxTidwell(potencias) a x y b) polinomio sobre x
#Mallas para el valor de potencia y grado de polinomio:
malla=seq(from = 1, to = 5, by = 1)
Poli <- cbind("poly", malla)
malla=seq(from = -3, to = 3, by = .5)
Pot <- cbind("pot", malla)
CompLin=rbind(Poli, Pot)
#Componente aleatorio: Y es continua y positiva, tenemos tres opciones:
#Malla con distribucion Normal, Gausiana e Inversa Gausiana
Distribuciones=c("gaussian", "Gamma", "inverse.gaussian")
#Funcion liga:inverse, identity, log, y 1/mu^2(solo para IG)
FunLigas=c("identity", "log", "inverse", "1/mu^2")
#Declaramos longitud o dimensión de los vectores
nFunLigas=length(FunLigas)
nDist=length(Distribuciones)
nCompLin=dim(CompLin)[1]
#Creación de variables para guardar resultados
ModelList=list(NA)  #guardar resultados del ajuste, objeto glm
AICList=list(NA)    #guardar el AIC del modelo
BICList=list(NA)    #guardar el BIC del modelo
FormList=list(NA)   #guardar la formula usada para el ajuste
#Modelos 18*2*3+18*1*4(tres funciones ligas para 2 distrib y 4 para una, IG)
#Generamos los cíclos y combinaciones de las mallas
index=0
for(k in 1:nCompLin){
#definimos componente lineal y formula
if(CompLin[k,1]=="poly"){
formstring=paste0("bpsystol ~ age+sex+poly(bmi,",  CompLin[k,2], ", raw=TRUE)")
}else{
if(CompLin[k,2]==0){
formstring=paste0("bpsystol ~ age+sex+I(log(bmi))")}else
{
formstring=paste0("bpsystol ~ age+sex+I(bmi^(",  CompLin[k,2], "))")}
}
form <- as.formula(formstring)
for(j in 1:nDist){
for(l in 1:nFunLigas){
#definicion del argumento family
if(FunLigas[l]=="1/mu^2"){
if(Distribuciones[j]=="inverse.gaussian"){
index=index+1
Dist=get(Distribuciones[j])  #obtener la funcion a usar
Mod.A.Prueba=glm(form, data=datos, family = Dist(link=FunLigas[l]))
ModelList[[index]]=Mod.A.Prueba
AICList[[index]]=AIC(Mod.A.Prueba)
BICList[[index]]=BIC(Mod.A.Prueba)
FormList[[index]]=formstring
}
}else{
index=index+1
Dist=get(Distribuciones[j])
Mod.A.Prueba=glm(form, data=datos, family = Dist(link=FunLigas[l]))
ModelList[[index]]=Mod.A.Prueba
AICList[[index]]=AIC(Mod.A.Prueba)
BICList[[index]]=BIC(Mod.A.Prueba)
FormList[[index]]=formstring
}
}
}
}
#El modelo con menor AIC
MinAIC=which.min(unlist(AICList))
ModMinAIC=ModelList[[MinAIC]]
#summary(ModMinAIC)
#Mostrar los AIC, BIC, modelo y liga
ModMinAIC$family
AICList[[MinAIC]]
BICList[[MinAIC]]
FormList[[MinAIC]]
modelo_glm1<-glm(formula = bpsystol ~ age+sex+bmi, family = inverse.gaussian(link = identity), data = datos)
#summary(modelo_glm1)
#stargazer(ModMinAIC, modelo_glm1)
K=matrix(c(0,1,0,0,
0,0,1,0,
0,0,0,1), ncol=4, nrow=3, byrow=TRUE)
m=c(0,0,0)
summary(glht(modelo_glm1, linfct=K, rhs=m), test=Chisqtest())
# Se incluye cierta aleatorización para datos binarios
library(statmod)
fitlogitqr <- qresid(modelo_glm1)
#qqnorm( fitlogitqr, las=1 ); qqline( fitlogitqr)
lilKS<-nortest::lillie.test(fitlogitqr)
Shapiro<-shapiro.test(fitlogitqr)
resid_panel(modelo_glm1, plots=c("all"),scale = 1)
set.seed(123)
fit2res <- simulateResiduals(fittedModel = modelo_glm1)
plot(fit2res)
K=matrix(c(0,0,0,1), ncol=4, nrow=1, byrow=TRUE)
m=0
prueba<-glht(modelo_glm1, linfct=K, rhs=m, alternative="greater")
#summary(prueba)
curva_ajustada_mujer30 <- function(x) {modelo_glm1$coefficients[1] + modelo_glm1$coefficients[4]*x + modelo_glm1$coefficients[3] + modelo_glm1$coefficients[2]*30}
curva_ajustada_hombre30 <- function(x) {modelo_glm1$coefficients[1] + modelo_glm1$coefficients[4]*x  + modelo_glm1$coefficients[2]*30}
curva_ajustada_mujer50 <- function(x) {modelo_glm1$coefficients[1] + modelo_glm1$coefficients[4]*x + modelo_glm1$coefficients[3] + modelo_glm1$coefficients[2]*50}
curva_ajustada_hombre50 <- function(x) {modelo_glm1$coefficients[1] + modelo_glm1$coefficients[4]*x  + modelo_glm1$coefficients[2]*50}
curva_ajustada_mujer64 <- function(x) {modelo_glm1$coefficients[1] + modelo_glm1$coefficients[4]*x + modelo_glm1$coefficients[3] + modelo_glm1$coefficients[2]*64}
curva_ajustada_hombre64 <- function(x) {modelo_glm1$coefficients[1] + modelo_glm1$coefficients[4]*x  + modelo_glm1$coefficients[2]*64}
ggplot(datos, aes(bmi, bpsystol)) +
geom_point() +
geom_function(fun = curva_ajustada_mujer30, aes(linetype = "mujer de 30") ,col="skyblue", lwd = 1) +
geom_function(fun = curva_ajustada_hombre30, aes(linetype = "hombre de 30") ,col="green") +
geom_function(fun = curva_ajustada_mujer50, aes(linetype = "mujer de 50") ,col="darkblue", lwd = 0.8) +
geom_function(fun = curva_ajustada_hombre50, aes(linetype = "hombre de 50") ,col="darkgreen") +
geom_function(fun = curva_ajustada_mujer64, aes(linetype = "mujer de 64") ,col="red") +
geom_function(fun = curva_ajustada_hombre64, aes(linetype = "hombre de 64") ,col="magenta") + theme_bw()
#Modelo Reg Lineal con logaritmos
modelo2=lm(data=datos, I(log(bpsystol)) ~ bmi + sex + age)
#summary(modelo2)
#summary(modelo_glm1)
#stargazer(modelo2, modelo_glm1)
#Modelo Reg Lineal con logaritmos
modelo2=lm(data=datos, I(log(bpsystol)) ~ bmi + sex + age)
#summary(modelo2)
#summary(modelo_glm1)
#stargazer(modelo2, modelo_glm1)
AIC(modelo2)
#Modelo Reg Lineal con logaritmos
modelo2=lm(data=datos, I(log(bpsystol)) ~ bmi + sex + age)
#summary(modelo2)
#summary(modelo_glm1)
#stargazer(modelo2, modelo_glm1)
AIC(modelo2)
exp(-376.2099)
#Modelo Reg Lineal con logaritmos
modelo2=lm(data=datos, I(log(bpsystol)) ~ bmi + sex + age)
#summary(modelo2)
#summary(modelo_glm1)
#stargazer(modelo2, modelo_glm1)
AIC(modelo2)
exp(376.2099)
exp(.009)
exp(-0.049)
exp(0.049)
