summary(modelo2)
table_tests2<-nice_assumptions(modelo2)
table_tests_fin2<-subset(table_tests2, select = -c(Model,Diagnostic) )
kable(t(table_tests_fin2)) %>%
kable_styling(bootstrap_options = "striped", full_width = F)
modelo2<-lm(data=datos, bpsystol ~ -1+bmi + sex + age)
summary(modelo2)
table_tests2<-nice_assumptions(modelo2)
table_tests_fin2<-subset(table_tests2, select = -c(Model,Diagnostic) )
kable(t(table_tests_fin2)) %>%
kable_styling(bootstrap_options = "striped", full_width = F)
modelo2<-lm(data=datos, bpsystol ~ -1+ log(bmi) + sex + age)
summary(modelo2)
table_tests2<-nice_assumptions(modelo2)
table_tests_fin2<-subset(table_tests2, select = -c(Model,Diagnostic) )
kable(t(table_tests_fin2)) %>%
kable_styling(bootstrap_options = "striped", full_width = F)
modelo2<-lm(data=datos, bpsystol ~ -1+ bmi + sex + age)
summary(modelo2)
table_tests2<-nice_assumptions(modelo2)
table_tests_fin2<-subset(table_tests2, select = -c(Model,Diagnostic) )
kable(t(table_tests_fin2)) %>%
kable_styling(bootstrap_options = "striped", full_width = F)
modelo2<-lm(data=datos, log(bpsystol) ~ -1+ bmi + sex + age)
summary(modelo2)
table_tests2<-nice_assumptions(modelo2)
table_tests_fin2<-subset(table_tests2, select = -c(Model,Diagnostic) )
kable(t(table_tests_fin2)) %>%
kable_styling(bootstrap_options = "striped", full_width = F)
modelo2<-lm(data=datos, log(bpsystol) ~ -1+ log(bmi) + sex + age)
summary(modelo2)
table_tests2<-nice_assumptions(modelo2)
table_tests_fin2<-subset(table_tests2, select = -c(Model,Diagnostic) )
kable(t(table_tests_fin2)) %>%
kable_styling(bootstrap_options = "striped", full_width = F)
modelo2<-lm(data=datos, bpsystol ~ -1+ bmi + sex + age)
summary(modelo2)
table_tests2<-nice_assumptions(modelo2)
table_tests_fin2<-subset(table_tests2, select = -c(Model,Diagnostic) )
kable(t(table_tests_fin2)) %>%
kable_styling(bootstrap_options = "striped", full_width = F)
glm1=glm(bpsystol~bmi+age+sex, data=datos, family = Gamma(link="inverse"))
summary(glm1)
table_tests2<-nice_assumptions(glm1)
table_tests_fin2<-subset(table_tests2, select = -c(Model,Diagnostic) )
kable(t(table_tests_fin2)) %>%
kable_styling(bootstrap_options = "striped", full_width = F)
glm1=glm(bpsystol~-1+bmi+age+sex, data=datos, family = Gamma(link="inverse"))
summary(glm1)
table_tests2<-nice_assumptions(glm1)
table_tests_fin2<-subset(table_tests2, select = -c(Model,Diagnostic) )
kable(t(table_tests_fin2)) %>%
kable_styling(bootstrap_options = "striped", full_width = F)
glm1=glm(bpsystol~I(log(bmi))+age+sex, data=datos, family = Gamma(link="inverse"))
summary(glm1)
table_tests2<-nice_assumptions(glm1)
table_tests_fin2<-subset(table_tests2, select = -c(Model,Diagnostic) )
kable(t(table_tests_fin2)) %>%
kable_styling(bootstrap_options = "striped", full_width = F)
glm1=glm(bpsystol~bm+age+sex, data=datos, family = Gamma(link="inverse"))
glm1=glm(bpsystol~bmi+age+sex, data=datos, family = Gamma(link="inverse"))
summary(glm1)
table_tests2<-nice_assumptions(glm1)
table_tests_fin2<-subset(table_tests2, select = -c(Model,Diagnostic) )
kable(t(table_tests_fin2)) %>%
kable_styling(bootstrap_options = "striped", full_width = F)
glm1=glm(bpsystol~bmi+age+sex, data=datos, family = poisson(link="log"))
summary(glm1)
table_tests2<-nice_assumptions(glm1)
table_tests_fin2<-subset(table_tests2, select = -c(Model,Diagnostic) )
kable(t(table_tests_fin2)) %>%
kable_styling(bootstrap_options = "striped", full_width = F)
glm1=glm(bpsystol~bmi+age+sex, data=datos, family = quasibinomial(link = "logit"))
glm1=glm(bpsystol~bmi+age+sex, data=datos, family = quasipoisson(link = "log"))
summary(glm1)
table_tests2<-nice_assumptions(glm1)
table_tests_fin2<-subset(table_tests2, select = -c(Model,Diagnostic) )
kable(t(table_tests_fin2)) %>%
kable_styling(bootstrap_options = "striped", full_width = F)
glm1=glm(bpsystol~bmi+age+sex, data=datos, family = Gamma(link = "inverse"))
summary(glm1)
table_tests2<-nice_assumptions(glm1)
table_tests_fin2<-subset(table_tests2, select = -c(Model,Diagnostic) )
kable(t(table_tests_fin2)) %>%
kable_styling(bootstrap_options = "striped", full_width = F)
glm1=glm(I(log(bpsystol))~bmi+age+sex, data=datos, family = Gamma(link = "inverse"))
summary(glm1)
table_tests2<-nice_assumptions(glm1)
table_tests_fin2<-subset(table_tests2, select = -c(Model,Diagnostic) )
kable(t(table_tests_fin2)) %>%
kable_styling(bootstrap_options = "striped", full_width = F)
glm1=glm(bpsystol~bmi+age+sex, data=datos, family = Gamma(link = "inverse"))
summary(glm1)
table_tests2<-nice_assumptions(glm1)
table_tests_fin2<-subset(table_tests2, select = -c(Model,Diagnostic) )
kable(t(table_tests_fin2)) %>%
kable_styling(bootstrap_options = "striped", full_width = F)
glm1=glm(I(log(bpsystol))~bmi+age+sex, data=datos, family = Gamma(link = "log"))
summary(glm1)
table_tests2<-nice_assumptions(glm1)
table_tests_fin2<-subset(table_tests2, select = -c(Model,Diagnostic) )
kable(t(table_tests_fin2)) %>%
kable_styling(bootstrap_options = "striped", full_width = F)
glm1=glm(bpsystol~bmi+age+sex, data=datos, family = Gamma(link = "log"))
summary(glm1)
table_tests2<-nice_assumptions(glm1)
table_tests_fin2<-subset(table_tests2, select = -c(Model,Diagnostic) )
kable(t(table_tests_fin2)) %>%
kable_styling(bootstrap_options = "striped", full_width = F)
glm1=glm(bpsystol~I(log(bmi))+age+sex, data=datos, family = Gamma(link = "log"))
summary(glm1)
table_tests2<-nice_assumptions(glm1)
table_tests_fin2<-subset(table_tests2, select = -c(Model,Diagnostic) )
kable(t(table_tests_fin2)) %>%
kable_styling(bootstrap_options = "striped", full_width = F)
glm1=glm(bpsystol~bmi+age+sex, data=datos, family = Gamma(link = "log"))
summary(glm1)
table_tests2<-nice_assumptions(glm1)
table_tests_fin2<-subset(table_tests2, select = -c(Model,Diagnostic) )
kable(t(table_tests_fin2)) %>%
kable_styling(bootstrap_options = "striped", full_width = F)
glm1=glm(bpsystol~bmi+age+sex, data=datos, family = Gamma(link = "log"))
summary(glm1)
table_tests2<-nice_assumptions(glm1)
table_tests_fin2<-subset(table_tests2, select = -c(Model,Diagnostic) )
kable(t(table_tests_fin2)) %>%
kable_styling(bootstrap_options = "striped", full_width = F)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(stargazer)
library(kableExtra)
datos<-read_csv("Preg1B.csv", show_col_types = FALSE)
modelo1<-lm(data=datos, bpsystol ~ bmi + sex + age)
#stargazer(modelo1)
#par(mfrow = c(2, 2))
#####check_model function of performance package: Grphs####
pkgs <- c(
"flextable", "performance", "see", "lmtest", "ggplot2",
"qqplotr", "ggrepel", "patchwork", "boot", "rempsyc", "report"
)
#install.packages(pkgs)
library(flextable)
library(performance)
library(see)
library(lmtest)
library(qqplotr)
library(ggrepel)
library(patchwork)
library(boot)
library(rempsyc)
library(report)
#check_model(modelo1) #check_model() function of the performance package
###check_model function of performance package: p-values ###
#check_collinearity(modelo1) # VIF
#check_autocorrelation(modelo1) #  Autocorrelated residuals p value
#check_heteroscedasticity(modelo1) # non-constant error variance (heteroscedasticity): p value
#check_outliers(modelo1) # Outliers method and threshold: cook
# check_normality(modelo1) # Normality of residuals p value
par(mfrow = c(2, 2))
plot(modelo1)
table_tests<-nice_assumptions(modelo1)
table_tests_fin<-subset(table_tests, select = -c(Model,Diagnostic) )
kable(t(table_tests_fin)) %>%
kable_styling(bootstrap_options = "striped", full_width = F)
View(datos)
datos<-read_csv("Preg1B.csv", show_col_types = FALSE)
datos$sex<-factor(datos$sex)
datos<-read_csv("Preg1B.csv", show_col_types = FALSE)
datos$sex<-factor(datos$sex) #declaramos la variable como factor
#Realizamos un relevel para poner como referencia "1"
datos$sex<-relevel(datos$sex,"1")
modelo1<-lm(data=datos, bpsystol ~ bmi + sex + age)
#stargazer(modelo1)
summary(modelo1)
#par(mfrow = c(2, 2))
#####check_model function of performance package: Grphs####
pkgs <- c(
"flextable", "performance", "see", "lmtest", "ggplot2",
"qqplotr", "ggrepel", "patchwork", "boot", "rempsyc", "report"
)
#install.packages(pkgs)
library(flextable)
library(performance)
library(see)
library(lmtest)
library(qqplotr)
library(ggrepel)
library(patchwork)
library(boot)
library(rempsyc)
library(report)
#check_model(modelo1) #check_model() function of the performance package
par(mfrow = c(2, 2))
plot(modelo1)
table_tests<-nice_assumptions(modelo1)
table_tests_fin<-subset(table_tests, select = -c(Model,Diagnostic) )
kable(t(table_tests_fin)) %>%
kable_styling(bootstrap_options = "striped", full_width = F)
modelo2=lm(data=datos, bpsystol ~ bmi + sex + age)
summary(modelo2)
table_tests2<-nice_assumptions(glm1)
table_tests2<-nice_assumptions(modelo2)
table_tests_fin2<-subset(table_tests2, select = -c(Model,Diagnostic) )
kable(t(table_tests_fin2)) %>%
kable_styling(bootstrap_options = "striped", full_width = F)
modelo2=lm(data=datos, I(log(bpsystol)) ~ bmi + sex + age)
summary(modelo2)
table_tests2<-nice_assumptions(modelo2)
table_tests_fin2<-subset(table_tests2, select = -c(Model,Diagnostic) )
kable(t(table_tests_fin2)) %>%
kable_styling(bootstrap_options = "striped", full_width = F)
summary(modelo1)
table_tests2<-nice_assumptions(modelo2)
table_tests_fin2<-subset(table_tests2, select = -c(Model,Diagnostic) )
kable(t(table_tests_fin2)) %>%
kable_styling(bootstrap_options = "striped", full_width = F)
par(mfrow = c(2, 2))
plot(modelo2)
stargazer(modelo2)
summary(modelo2)
exp(0.0093654)
exp(0.009)
summary(modelo1)
exp(-0.0490340)
exp(0.0490340)
exp(0.0490340*2)
exp(-0.0490340*2)
exp(0.0037128)
exp(4.4611178)
exp(0.0037128)
exp(-0.0490340)
dat<-datos
dat<-datos
dat$sex[1]
dat<-datos
dat$sex[1]<-"0"
dat<-datos
dat$sex["1"]<-"0"
dat<-datos
dat$sex["1"]<-dat$sex["0"]
dat<-datos
dat$sex[1]<-0
dat<-datos
dat$sex[dat$sex == '1'] <- '0'
dat<-datos
dat$sex[dat$sex == 1] <- 0
dat<-datos
dat<-replace(dat$sex, dat$sex<2, 0)
dat<-datos
dat<-replace(dat$sex, dat$sex==1, 0)
dat<-datos
dat<-replace(dat$sex, dat$sex=="1", "0")
dat<-datos
dat<-replace(dat$sex, dat$sex==1, "0")
dat<-datos
dat<-replace(dat$sex, dat$sex==1, 0)
dat<-datos
dat$sex<-as.numeric(dat$sex)
dat<-replace(dat$sex, dat$sex==1, 0)
dat<-datos
dat$sex<-as.numeric(dat$sex)
dat<-replace(dat$sex, dat$sex==1, 0)
dat<-replace(dat$sex, dat$sex==2, 1)
dat<-datos
dat$sex<-as.numeric(dat$sex)
dat<-replace(dat$sex, dat$sex==1, 0)
dat<-datos
dat$sex<-as.numeric(dat$sex)
dat<-replace(dat$sex, dat$sex==2, 0)
dat<-datos
dat$sex<-as.numeric(dat$sex)
dat<-replace(dat$sex, dat$sex==2, 0)
dat<-as.data.frame(dat)
View(dat)
dat<-datos
dat$sex<-as.numeric(dat$sex)
dat$sex<-replace(dat$sex, dat$sex==2, 0)
dat<-as.data.frame(dat)
View(dat)
lm(data=dat, bpsystol ~ bmi + sex + age)
dat<-datos
dat$sex<-as.numeric(dat$sex)
dat$sex<-replace(dat$sex, dat$sex==2, 0)
dat<-as.data.frame(dat)
dat$sex<-relevel(dat$sex,"1")
dat<-datos
dat$sex<-as.numeric(dat$sex)
dat$sex<-replace(dat$sex, dat$sex==2, 0)
dat<-as.data.frame(dat)
dat$sex<-factor(dat$sex)
dat$sex<-relevel(dat$sex,"1")
lm(data=dat, bpsystol ~ bmi + sex + age)
lm(data=dat, log(bpsystol) ~ bmi + sex + age)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(stargazer)
library(kableExtra)
datos<-read_csv("Preg1B.csv", show_col_types = FALSE)
datos$sex<-factor(datos$sex) #declaramos la variable como factor
#Realizamos un relevel para poner como referencia "1"
datos$sex<-relevel(datos$sex,"1")
modelo1<-lm(data=datos, bpsystol ~ bmi + sex + age)
#stargazer(modelo1)
#par(mfrow = c(2, 2))
#####check_model function of performance package: Grphs####
pkgs <- c(
"flextable", "performance", "see", "lmtest", "ggplot2",
"qqplotr", "ggrepel", "patchwork", "boot", "rempsyc", "report"
)
#install.packages(pkgs)
library(flextable)
library(performance)
library(see)
library(lmtest)
library(qqplotr)
library(ggrepel)
library(patchwork)
library(boot)
library(rempsyc)
library(report)
#check_model(modelo1) #check_model() function of the performance package
###check_model function of performance package: p-values ###
#check_collinearity(modelo1) # VIF
#check_autocorrelation(modelo1) #  Autocorrelated residuals p value
#check_heteroscedasticity(modelo1) # non-constant error variance (heteroscedasticity): p value
#check_outliers(modelo1) # Outliers method and threshold: cook
# check_normality(modelo1) # Normality of residuals p value
par(mfrow = c(2, 2))
plot(modelo1)
table_tests<-nice_assumptions(modelo1)
table_tests_fin<-subset(table_tests, select = -c(Model,Diagnostic) )
kable(t(table_tests_fin)) %>%
kable_styling(bootstrap_options = "striped", full_width = F)
modelo2=lm(data=datos, I(log(bpsystol)) ~ bmi + sex + age)
#summary(modelo2)
#stargazer(modelo2)
par(mfrow = c(2, 2))
plot(modelo2)
table_tests2<-nice_assumptions(modelo2)
table_tests_fin2<-subset(table_tests2, select = -c(Model,Diagnostic) )
kable(t(table_tests_fin2)) %>%
kable_styling(bootstrap_options = "striped", full_width = F)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(stargazer)
library(kableExtra)
datos<-read_csv("Preg1B.csv", show_col_types = FALSE)
datos$sex<-factor(datos$sex) #declaramos la variable como factor
#Realizamos un relevel para poner como referencia "1"
datos$sex<-relevel(datos$sex,"1")
modelo1<-lm(data=datos, bpsystol ~ bmi + sex + age)
#stargazer(modelo1)
#par(mfrow = c(2, 2))
#####check_model function of performance package: Grphs####
pkgs <- c(
"flextable", "performance", "see", "lmtest", "ggplot2",
"qqplotr", "ggrepel", "patchwork", "boot", "rempsyc", "report"
)
#install.packages(pkgs)
library(flextable)
library(performance)
library(see)
library(lmtest)
library(qqplotr)
library(ggrepel)
library(patchwork)
library(boot)
library(rempsyc)
library(report)
#check_model(modelo1) #check_model() function of the performance package
###check_model function of performance package: p-values ###
#check_collinearity(modelo1) # VIF
#check_autocorrelation(modelo1) #  Autocorrelated residuals p value
#check_heteroscedasticity(modelo1) # non-constant error variance (heteroscedasticity): p value
#check_outliers(modelo1) # Outliers method and threshold: cook
# check_normality(modelo1) # Normality of residuals p value
par(mfrow = c(2, 2))
plot(modelo1)
table_tests<-nice_assumptions(modelo1)
table_tests_fin<-subset(table_tests, select = -c(Model,Diagnostic) )
kable(t(table_tests_fin)) %>%
kable_styling(bootstrap_options = "striped", full_width = F)
modelo2=lm(data=datos, I(log(bpsystol)) ~ bmi + sex + age)
#summary(modelo2)
#stargazer(modelo2)
par(mfrow = c(2, 2))
plot(modelo2)
table_tests2<-nice_assumptions(modelo2)
table_tests_fin2<-subset(table_tests2, select = -c(Model,Diagnostic) )
kable(t(table_tests_fin2)) %>%
kable_styling(bootstrap_options = "striped", full_width = F)
modelo2$coefficients[1]
summary(modelo2)
curva_ajustada <- function(x) {exp(modelo2$coefficients[1] + modelo2$coefficients[2]*x + modelo2$coefficients[3] + modelo2$coefficients[4]*30)}
View(datos)
ggplot(datos, aes(bmi, bpsystol)) +
geom_point() +
geom_function(fun = curva_ajustada) + theme_bw()
curva_ajustada_mujer30 <- function(x) {exp(modelo2$coefficients[1] + modelo2$coefficients[2]*x + modelo2$coefficients[3] + modelo2$coefficients[4]*30)}
curva_ajustada_hombre30 <- function(x) {exp(modelo2$coefficients[1] + modelo2$coefficients[2]*x  + modelo2$coefficients[4]*30)}
ggplot(datos, aes(bmi, bpsystol)) +
geom_point() +
geom_function(fun = curva_ajustada_mujer30) +
geom_function(fun = curva_ajustada_hombre30)
+ theme_bw()
ggplot(datos, aes(bmi, bpsystol)) +
geom_point() +
geom_function(fun = curva_ajustada_mujer30) +
geom_function(fun = curva_ajustada_hombre30) + theme_bw()
ggplot(datos, aes(bmi, bpsystol)) +
geom_point() +
geom_function(fun = curva_ajustada_mujer30, col="blue") +
geom_function(fun = curva_ajustada_hombre30) + theme_bw()
ggplot(datos, aes(bmi, bpsystol)) +
geom_point() +
geom_function(fun = curva_ajustada_mujer30, col="blue") +
geom_function(fun = curva_ajustada_hombre30, col="green") + theme_bw()
ggplot(datos, aes(bmi, bpsystol)) +
geom_point() +
geom_function(fun = curva_ajustada_mujer30,aes(linetype = "b") ,col="blue") +
geom_function(fun = curva_ajustada_hombre30, col="green") + theme_bw()
ggplot(datos, aes(bmi, bpsystol)) +
geom_point() +
geom_function(fun = curva_ajustada_mujer30, aes(linetyp = "b") ,col="blue") +
geom_function(fun = curva_ajustada_hombre30, col="green") + theme_bw()
ggplot(datos, aes(bmi, bpsystol)) +
geom_point() +
geom_function(fun = curva_ajustada_mujer30, aes(linetype = "b") ,col="blue") +
geom_function(fun = curva_ajustada_hombre30, col="green") + theme_bw()
ggplot(datos, aes(bmi, bpsystol)) +
geom_point() +
geom_function(fun = curva_ajustada_mujer30, aes(linetype = "mujer de 30") ,col="blue") +
geom_function(fun = curva_ajustada_hombre30, aes(linetype = "hombre de 30") ,col="green") + theme_bw()
ggplot(datos, aes(bmi, bpsystol)) +
geom_point() +
geom_function(fun = curva_ajustada_mujer30, aes(linetype = "mujer de 30") ,col="blue") +
geom_function(fun = curva_ajustada_hombre30, aes(linetype = "hombre de 30") ,col="green") +
geom_function(fun = curva_ajustada_mujer50, aes(linetype = "mujer de 50") ,col="pink") +
geom_function(fun = curva_ajustada_hombre50, aes(linetype = "hombre de 50") ,col="yellow") + theme_bw()
curva_ajustada_mujer30 <- function(x) {exp(modelo2$coefficients[1] + modelo2$coefficients[2]*x + modelo2$coefficients[3] + modelo2$coefficients[4]*30)}
curva_ajustada_hombre30 <- function(x) {exp(modelo2$coefficients[1] + modelo2$coefficients[2]*x  + modelo2$coefficients[4]*30)}
curva_ajustada_mujer50 <- function(x) {exp(modelo2$coefficients[1] + modelo2$coefficients[2]*x + modelo2$coefficients[3] + modelo2$coefficients[4]*50)}
curva_ajustada_hombre50 <- function(x) {exp(modelo2$coefficients[1] + modelo2$coefficients[2]*x  + modelo2$coefficients[4]*50)}
ggplot(datos, aes(bmi, bpsystol)) +
geom_point() +
geom_function(fun = curva_ajustada_mujer30, aes(linetype = "mujer de 30") ,col="blue") +
geom_function(fun = curva_ajustada_hombre30, aes(linetype = "hombre de 30") ,col="green") +
geom_function(fun = curva_ajustada_mujer50, aes(linetype = "mujer de 50") ,col="pink") +
geom_function(fun = curva_ajustada_hombre50, aes(linetype = "hombre de 50") ,col="yellow") + theme_bw()
ggplot(datos, aes(bmi, bpsystol)) +
geom_point() +
geom_function(fun = curva_ajustada_mujer30, aes(linetype = "mujer de 30") ,col="skyblue") +
geom_function(fun = curva_ajustada_hombre30, aes(linetype = "hombre de 30") ,col="green") +
geom_function(fun = curva_ajustada_mujer50, aes(linetype = "mujer de 50") ,col="darkblue") +
geom_function(fun = curva_ajustada_hombre50, aes(linetype = "hombre de 50") ,col="darkgreen") + theme_bw()
ggplot(datos, aes(bmi, bpsystol)) +
geom_point() +
geom_function(fun = curva_ajustada_mujer30, aes(linetype = "mujer de 30") ,col="skyblue", lwd = 1) +
geom_function(fun = curva_ajustada_hombre30, aes(linetype = "hombre de 30") ,col="green") +
geom_function(fun = curva_ajustada_mujer50, aes(linetype = "mujer de 50") ,col="darkblue") +
geom_function(fun = curva_ajustada_hombre50, aes(linetype = "hombre de 50") ,col="darkgreen") + theme_bw()
ggplot(datos, aes(bmi, bpsystol)) +
geom_point() +
geom_function(fun = curva_ajustada_mujer30, aes(linetype = "mujer de 30") ,col="skyblue", lwd = 1, linetype = 1) +
geom_function(fun = curva_ajustada_hombre30, aes(linetype = "hombre de 30") ,col="green") +
geom_function(fun = curva_ajustada_mujer50, aes(linetype = "mujer de 50") ,col="darkblue") +
geom_function(fun = curva_ajustada_hombre50, aes(linetype = "hombre de 50") ,col="darkgreen") + theme_bw()
ggplot(datos, aes(bmi, bpsystol)) +
geom_point() +
geom_function(fun = curva_ajustada_mujer30, aes(linetype = "mujer de 30") ,col="skyblue", lwd = 1) +
geom_function(fun = curva_ajustada_hombre30, aes(linetype = "hombre de 30") ,col="green") +
geom_function(fun = curva_ajustada_mujer50, aes(linetype = "mujer de 50") ,col="darkblue") +
geom_function(fun = curva_ajustada_hombre50, aes(linetype = "hombre de 50") ,col="darkgreen") + theme_bw()
ggplot(datos, aes(bmi, bpsystol)) +
geom_point() +
geom_function(fun = curva_ajustada_mujer30, aes(linetype = "mujer de 30") ,col="skyblue", lwd = 1) +
geom_function(fun = curva_ajustada_hombre30, aes(linetype = "hombre de 30") ,col="green") +
geom_function(fun = curva_ajustada_mujer50, aes(linetype = "mujer de 50") ,col="darkblue") +
geom_function(fun = curva_ajustada_hombre50, aes(linetype = "hombre de 50") ,col="darkgreen") +
geom_function(fun = curva_ajustada_mujer64, aes(linetype = "mujer de 64") ,col="red") +
geom_function(fun = curva_ajustada_hombre64, aes(linetype = "hombre de 64") ,col="magenta")
curva_ajustada_mujer30 <- function(x) {exp(modelo2$coefficients[1] + modelo2$coefficients[2]*x + modelo2$coefficients[3] + modelo2$coefficients[4]*30)}
curva_ajustada_hombre30 <- function(x) {exp(modelo2$coefficients[1] + modelo2$coefficients[2]*x  + modelo2$coefficients[4]*30)}
curva_ajustada_mujer50 <- function(x) {exp(modelo2$coefficients[1] + modelo2$coefficients[2]*x + modelo2$coefficients[3] + modelo2$coefficients[4]*50)}
curva_ajustada_hombre50 <- function(x) {exp(modelo2$coefficients[1] + modelo2$coefficients[2]*x  + modelo2$coefficients[4]*50)}
curva_ajustada_mujer64 <- function(x) {exp(modelo2$coefficients[1] + modelo2$coefficients[2]*x + modelo2$coefficients[3] + modelo2$coefficients[4]*64)}
curva_ajustada_hombre64 <- function(x) {exp(modelo2$coefficients[1] + modelo2$coefficients[2]*x  + modelo2$coefficients[4]*64)}
ggplot(datos, aes(bmi, bpsystol)) +
geom_point() +
geom_function(fun = curva_ajustada_mujer30, aes(linetype = "mujer de 30") ,col="skyblue", lwd = 1) +
geom_function(fun = curva_ajustada_hombre30, aes(linetype = "hombre de 30") ,col="green") +
geom_function(fun = curva_ajustada_mujer50, aes(linetype = "mujer de 50") ,col="darkblue") +
geom_function(fun = curva_ajustada_hombre50, aes(linetype = "hombre de 50") ,col="darkgreen") +
geom_function(fun = curva_ajustada_mujer64, aes(linetype = "mujer de 64") ,col="red") +
geom_function(fun = curva_ajustada_hombre64, aes(linetype = "hombre de 64") ,col="magenta")
+ theme_bw()
ggplot(datos, aes(bmi, bpsystol)) +
geom_point() +
geom_function(fun = curva_ajustada_mujer30, aes(linetype = "mujer de 30") ,col="skyblue", lwd = 1) +
geom_function(fun = curva_ajustada_hombre30, aes(linetype = "hombre de 30") ,col="green") +
geom_function(fun = curva_ajustada_mujer50, aes(linetype = "mujer de 50") ,col="darkblue", lwd = 0.8) +
geom_function(fun = curva_ajustada_hombre50, aes(linetype = "hombre de 50") ,col="darkgreen") +
geom_function(fun = curva_ajustada_mujer64, aes(linetype = "mujer de 64") ,col="red") +
geom_function(fun = curva_ajustada_hombre64, aes(linetype = "hombre de 64") ,col="magenta") + theme_bw()
ggplot(datos, aes(bmi, bpsystol)) +
geom_point() +
geom_function(fun = curva_ajustada_mujer30, aes(linetype = "mujer de 30") ,col="skyblue", lwd = 1) +
geom_function(fun = curva_ajustada_hombre30, aes(linetype = "hombre de 30") ,col="green") +
geom_function(fun = curva_ajustada_mujer50, aes(linetype = "mujer de 50") ,col="darkblue", lwd = 0.8) +
geom_function(fun = curva_ajustada_hombre50, aes(linetype = "hombre de 50") ,col="darkgreen") +
geom_function(fun = curva_ajustada_mujer64, aes(linetype = "mujer de 64") ,col="red") +
geom_function(fun = curva_ajustada_hombre64, aes(linetype = "hombre de 64") ,col="magenta") + theme_bw()
