p1+ ggplot(data=datosfin, aes(x=Deposit,y=prob_s, colour=Insecticide))+ geom_point()+ theme_classic()
p1<-ggplot(data=datosfin, aes(x=Deposit,y=p_Killed, colour=Insecticide))+
p1+ ggplot(data=datosfin, aes(x=Deposit,y=prob_s, colour=Insecticide))+ geom_point()+ theme_classic()
p1<-ggplot(data=datosfin, aes(x=Deposit,y=p_Killed, colour=Insecticide))
p1+ ggplot(data=datosfin, aes(x=Deposit,y=prob_s, colour=Insecticide))+ geom_point()+ theme_classic()
p1<-ggplot(data=datosfin, aes(x=Deposit,y=p_Killed, colour=Insecticide))+geom_point()+ theme_classic()
p1+ ggplot(data=datosfin, aes(x=Deposit,y=prob_s, colour=Insecticide))+ geom_point()+ theme_classic()
p1<-ggplot(data=datosfin, aes(x=Deposit,y=p_Killed, colour=Insecticide))+geom_point()+ theme_classic()
par(new=TRUE)
p1+ ggplot(data=datosfin, aes(x=Deposit,y=prob_s, colour=Insecticide))+ geom_point()+ theme_classic()
p1<-ggplot(data=datosfin, aes(x=Deposit,y=p_Killed, colour=Insecticide))+geom_point()+ theme_classic()
p1+ ggplot(data=datosfin, aes(x=Deposit,y=prob_s, colour=Insecticide))+ geom_point()+ theme_classic()
scale_y_continuous(sec.axis = sec_axis(~ .*1, labels = number_format(scale=1/scale_factor), name="Flow"))
ggplot(data=datosfin, aes(x=Deposit,y=p_Killed, colour=Insecticide))+geom_point()+ theme_classic()
ggplot(data=datosfin, aes(x=Deposit,y=prob_s, colour=Insecticide))+ geom_point()+ theme_classic()
scale_y_continuous(sec.axis = sec_axis(~ .*1, labels = number_format(scale=1/scale_factor), name="Flow"))
ggplot(data=datosfin, aes(x=Deposit,y=p_Killed, colour=Insecticide))+geom_point()+ theme_classic()
ggplot(data=datosfin, aes(x=Deposit,y=prob_s, colour=Insecticide))+ geom_point()+ theme_classic()+
scale_y_continuous(sec.axis = sec_axis(~ .*1, labels = number_format(scale=1/scale_factor), name="Flow"))
ggplot(data=datosfin, aes(x=Deposit,y=p_Killed, colour=Insecticide))+geom_point()+ theme_classic()
ggplot(data=datosfin, aes(x=Deposit,y=prob_s, colour=Insecticide))+ geom_point()+ theme_classic()+
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="Flow"))
p1<-ggplot(data=datosfin, aes(x=Deposit,y=p_Killed, colour=Insecticide))+geom_point()+ theme_classic()
p1+ggplot(data=datosfin, aes(x=Deposit,y=prob_s, colour=Insecticide))+ geom_point()+ theme_classic()+
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="Flow"))
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = p_Killed)) +
geom_point(aes(y = prob_s)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="Flow"))
ggplot(data=datosfin, aes(x=Deposit,y=p_Killed, colour=Insecticide))+geom_point()+ theme_classic()
ggplot(data=datosfin, aes(x=Deposit,y=prob_s, colour=Insecticide))+ geom_point()+ theme_classic()+
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="Flow"))
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = p_Killed, colour=Insecticide)) +
geom_point(aes(y = prob_s, colour=Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="Flow"))
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = p_Killed, colour=Insecticide)) +
geom_point(aes(y = prob_s, colour=Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="Flow")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = p_Killed, colour=Insecticide, shape =Insecticide)) +
geom_point(aes(y = prob_s, colour=Insecticide, shape =Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="Flow")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = p_Killed, colour='red', shape =Insecticide)) +
geom_point(aes(y = prob_s, colour='blue', shape =Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="Flow")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = p_Killed, colour='red', shape =Insecticide)) +
geom_point(aes(y = prob_s, colour='blue', shape =Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="prob_s")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = p_Killed, colour='red', shape =factor(Insecticide))) +
geom_point(aes(y = prob_s, colour='blue', shape =factor(Insecticide))) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="prob_s")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = p_Killed, colour='red', shape =Insecticide)) +
geom_point(aes(y = prob_s, colour='blue', shape =Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="prob_s")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = p_Killed, colou='red', shape =Insecticide)) +
geom_point(aes(y = prob_s, colour='blue', shape =Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="prob_s")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = p_Killed, colour='red', shape =Insecticide)) +
geom_point(aes(y = prob_s, colour='blue', shape =Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="prob_s")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = p_Killed, colour='blue', shape =Insecticide)) +
geom_point(aes(y = prob_s, colour='red', shape =Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="prob_s")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = p_Killed, colour=Insecticide, shape =21)) +
geom_point(aes(y = prob_s, colour=Insecticide, shape =5)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="prob_s")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = p_Killed, colour=Insecticide, shape = 2)) +
geom_point(aes(y = prob_s, colour=Insecticide, shape = 5)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="prob_s")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = p_Killed, colour=Insecticide, shape =Insecticide )) +
geom_point(aes(y = prob_s, colour=Insecticide, shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="prob_s")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = p_Killed, colour=Insecticide, shape =Insecticide )) +
geom_point(aes(y = prob_s, colour=Insecticide, shape = Insecticide, size=3)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="prob_s")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = p_Killed, colour=Insecticide, shape =Insecticide )) +
geom_point(aes(y = prob_s, colour=Insecticide, shape = Insecticide, size=0.5)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="prob_s")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = p_Killed, colour=Insecticide, shape =Insecticide )) +
geom_point(aes(y = prob_s, colour=Insecticide, shape = Insecticide, size=20)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="prob_s")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = p_Killed, colour=Insecticide, shape =Insecticide )) +
geom_point(aes(y = prob_s, colour=Insecticide, shape = Insecticide, size=1)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="prob_s")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = p_Killed, colour=Insecticide, shape =Insecticide, size=2 )) +
geom_point(aes(y = prob_s, colour=Insecticide, shape = Insecticide, size=1)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="prob_s")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = p_Killed, colour=Insecticide, shape =Insecticide, size=1 )) +
geom_point(aes(y = prob_s, colour=Insecticide, shape = Insecticide, size=1)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="prob_s")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = p_Killed, colour=Insecticide, shape =Insecticide, size=0.5 )) +
geom_point(aes(y = prob_s, colour=Insecticide, shape = Insecticide, size=1)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="prob_s")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = p_Killed, colour=Insecticide, shape =Insecticide, size=0.5 )) +
geom_point(aes(y = prob_s, colour=Insecticide, shape = Insecticide, size=0.5)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="prob_s")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = p_Killed, colour=Insecticide, shape =Insecticide, size=0.1 )) +
geom_point(aes(y = prob_s, colour=Insecticide, shape = Insecticide, size=0.1)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="prob_s")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = p_Killed, colour=Insecticide, shape =Insecticide, size=0.2 )) +
geom_point(aes(y = prob_s, colour=Insecticide, shape = Insecticide, size=0.1)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="prob_s")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = p_Killed, colour=Insecticide, shape =Insecticide )) +
geom_point(aes(y = prob_s, colour=Insecticide, shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="prob_s")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = p_Killed, colour="green", shape =Insecticide )) +
geom_point(aes(y = prob_s, colour="magenta", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="prob_s")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = p_Killed, colour="orange", shape =Insecticide )) +
geom_point(aes(y = prob_s, colour="magenta", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="prob_s")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = p_Killed, colour="orange", shape =Insecticide )) +
geom_point(aes(y = prob_s, colour="cyan", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="prob_s")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = p_Killed, colour="cyan", shape =Insecticide )) +
geom_point(aes(y = prob_s, colour="orange", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="prob_s")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = prob_s, colour="cyan", shape =Insecticide )) +
geom_point(aes(y = p_Killed, colour="orange", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="prob_s")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = prob_s, colour="cyan", shape =Insecticide )) +
geom_point(aes(y = p_Killed, colour="orange", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="p_Killed")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = prob_s, colour="green", shape =Insecticide )) +
geom_point(aes(y = p_Killed, colour="purple", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="p_Killed")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = prob_s, colour="orange", shape =Insecticide )) +
geom_point(aes(y = p_Killed, colour="purple", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="p_Killed")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = prob_s, colour="orange", shape =Insecticide )) +
geom_point(aes(y = p_Killed, colour="cyan", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="p_Killed")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = prob_s, colour="orange", shape =Insecticide )) +
geom_point(aes(y = p_Killed, colour="cyan", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="p_Killed")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = prob_s, colour="orange", shape =Insecticide )) +
geom_point(aes(y = p_Killed, colour="cyan", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="p_Killed")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = prob_s, colour="orange", shape =Insecticide )) +
geom_point(aes(y = p_Killed, colour="cyan", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="p_Killed")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = prob_s, colour="orange", shape =Insecticide )) +
geom_point(aes(y = p_Killed, colour="cyan", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="p_Killed")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = prob_s, colour="orange", shape =Insecticide )) +
geom_point(aes(y = p_Killed, colour="cyan", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="p_Killed")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = prob_s, colour="orange", shape =Insecticide )) +
geom_point(aes(y = p_Killed, colour="cyan", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="p_Killed")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = prob_s, colour="orange", shape =Insecticide )) +
geom_point(aes(y = p_Killed, colour="purple", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="p_Killed")) + theme_classic()
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(stargazer)
library(kableExtra)
datos<-read_csv("https://raw.githubusercontent.com/LeobardoEnriquezH/Data/main/Preg3B.csv", show_col_types = FALSE)
datos$Insecticide<-factor(datos$Insecticide) #declaramos la variable como factor
#Realizamos un relevel para poner como referencia "1"
datos$Insecticide<-relevel(datos$Insecticide,"A")
#Creamos dato de proporcion de insectos que mueren
datos$p_Killed<-datos$Killed/datos$Number
ggplot(data=datos, aes(x=Deposit,y=p_Killed, colour=Insecticide))+ geom_point()+ theme_classic()
#Convertimos a datos desagrupados (más común en la práctica)
#library(tidyverse)
datos$NoKilled<-datos$Number-datos$Killed
datna_1=datos %>% group_by(Killed,Insecticide,Deposit) %>%
do( data.frame(died= rep(1, .$Killed)))
datna_2=datos %>% group_by(Killed,Insecticide,Deposit) %>%
do( data.frame(died= rep(0, .$NoKilled)))
datna<-rbind(datna_1,datna_2)
#Generar variables con datos en logaritmos
datna$lnD=log(datna$Deposit)
#datos$lnD=factor(datos$lnD) #declaramos la variable como factor
#En general hay 4 ligas que se podrían usar para covariables factores: logit, probit, cloglog y log.
#Aqui emplearemos 3 ligas porque tenemos una variable numérica entre las covariables, omitimos liga log.
fitlogit=glm(died~Insecticide*lnD, family = binomial(link="logit"), data=datna)
#summary(fitlogit)
fitprob=glm(died~Insecticide*lnD, family = binomial(link="probit"), data=datna)
#summary(fitprob)
fitcll=glm(died~Insecticide*lnD, family = binomial(link="cloglog"), data=datna)
#summary(fitcll)
#En general hay 4 ligas que se podrían usar para covariables factores: logit, probit, cloglog y log.
#Aqui emplearemos 3 ligas porque tenemos una variable numérica entre las covariables, omitimos liga log.
fitlogit_s=glm(died~Insecticide+lnD, family = binomial(link="logit"), data=datna)
#summary(fitlogit)
fitprob_s=glm(died~Insecticide+lnD, family = binomial(link="probit"), data=datna)
#summary(fitprob)
fitcll_s=glm(died~Insecticide+lnD, family = binomial(link="cloglog"), data=datna)
#summary(fitcll)
#stargazer(fitlogit, fitprob, fitcll, fitlogit_s, fitprob_s, fitcll_s)
#A continuación se muestran los valores AIC y BIC, respectivamente, para las ligas logit, probit y cloglog. Como se mencinó anteriormente, se elige el modelo con el menor AIC, que es el de la liga probit.
#Además con el modelo completo también los criterios AIC y BIC coinciden
# ("AIC:logit probit cloglog")
# c(AIC(fitlogit), AIC(fitprob),  AIC(fitcll))
# ("BIC:logit probit cloglog")
# c(BIC(fitlogit), BIC(fitprob), BIC(fitcll))
#La primera prueba que se debe realizar es
#la similar a la prueba asociada a la tabla ANOVA en regresión lineal múltiple
# library(multcomp)
# K=matrix(c(0,1,0,0,
#            0,0,1,0,
#            0,0,0,1), ncol=4, nrow=3, byrow=TRUE)
# m=c(0,0,0)
# summary(glht(fitprob_s, linfct=K, rhs=m), test=Chisqtest())  #Chisqtest() es apropiada para datos donde y no es continua
# Se rechaza H0, lo que implica que se puede proceder
# al análisis del modelo
datna$lnD2=datna$lnD*datna$lnD
#En general hay 4 ligas que se podrían usar para covariables factores: logit, probit, cloglog y log.
#Aqui emplearemos 3 ligas porque tenemos una variable numérica entre las covariables, omitimos liga log.
fitlogit=glm(died~Insecticide*lnD+Insecticide*lnD2, family = binomial(link="logit"), data=datna)
#summary(fitlogit)
fitprob=glm(died~Insecticide*lnD+Insecticide*lnD2, family = binomial(link="probit"), data=datna)
#summary(fitprob)
fitcll=glm(died~Insecticide*lnD+Insecticide*lnD2, family = binomial(link="cloglog"), data=datna)
#summary(fitcll)
#En general hay 4 ligas que se podrían usar para covariables factores: logit, probit, cloglog y log.
#Aqui emplearemos 3 ligas porque tenemos una variable numérica entre las covariables, omitimos liga log.
fitlogit_s=glm(died~Insecticide+lnD +lnD2, family = binomial(link="logit"), data=datna)
#summary(fitlogit)
fitprob_s=glm(died~Insecticide+lnD +lnD2, family = binomial(link="probit"), data=datna)
#summary(fitprob)
fitcll_s=glm(died~Insecticide+lnD +lnD2, family = binomial(link="cloglog"), data=datna)
#summary(fitcll)
#stargazer(fitlogit, fitprob, fitcll, fitlogit_s, fitprob_s, fitcll_s)
#Además con el modelo completo también los criterios AIC y BIC coinciden
# ("AIC:logit probit cloglog")
# c(AIC(fitlogit), AIC(fitprob),  AIC(fitcll))
# ("BIC:logit probit cloglog")
# c(BIC(fitlogit), BIC(fitprob), BIC(fitcll))
#La primera prueba que se debe realizar es
#la similar a la prueba asociada a la tabla ANOVA en regresión lineal múltiple
# library(multcomp)
# K=matrix(c(0,1,0,0,0,
#            0,0,1,0,0,
#            0,0,0,1,0,
#            0,0,0,0,1), ncol=5, nrow=4, byrow=TRUE)
# m=c(0,0,0,0)
# summary(glht(fitprob_s, linfct=K, rhs=m), test=Chisqtest())  #Chisqtest() es apropiada para datos donde y no es continua
# Se rechaza H0, lo que implica que se puede proceder
# al análisis del modelo
newdata <- data.frame(Insecticide = c("A", "A","A","A", "A","A","B","B", "B", "B","B", "B","C","C", "C", "C","C", "C"), lnD = c(0.6931472, 0.9707789, 1.2470323,1.5238800, 1.8017098, 2.0794415, 0.6931472, 0.9707789, 1.2470323,1.5238800, 1.8017098, 2.0794415, 0.6931472, 0.9707789, 1.2470323,1.5238800, 1.8017098, 2.0794415), lnD2 = c(0.4804530, 0.9424117, 1.5550895,2.32221, 3.246158, 4.32407, 0.4804530, 0.9424117, 1.5550895,2.32221, 3.246158, 4.32407, 0.4804530, 0.9424117, 1.5550895,2.32221, 3.246158, 4.32407) )
newdata$prob_s <- predict(fitprob_s, newdata[,1:3], type = c("response"), se.fit=TRUE)$fit
newdata$Deposit<-exp(newdata$lnD)
newdata
newdata1<- newdata[,-c(1,5)]
datosfin<-cbind(datos,newdata1)
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = prob_s, colour="orange", shape =Insecticide )) +
geom_point(aes(y = p_Killed, colour="purple", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="p_Killed")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = prob_s, colour="orange", shape =Insecticide )) +
geom_point(aes(y = p_Killed, colour="blue", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="p_Killed")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = prob_s, colour="orange", shape =Insecticide )) +
geom_point(aes(y = p_Killed, colour="cyan", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="p_Killed")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = prob_s, colour="orange", shape =Insecticide )) +
geom_point(aes(y = p_Killed, colour="purple", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="p_Killed")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = prob_s, colour="orange", shape =Insecticide )) +
geom_point(aes(y = p_Killed, colour="cyan2", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="p_Killed")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = prob_s, colour="orange", shape =Insecticide )) +
geom_point(aes(y = p_Killed, colour="cyan3", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="p_Killed")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = prob_s, colour="orange", shape =Insecticide )) +
geom_point(aes(y = p_Killed, colour="cyan4", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="p_Killed")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = prob_s, colour="orange", shape =Insecticide )) +
geom_point(aes(y = p_Killed, colour="cyan5", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="p_Killed")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = prob_s, colour="orange", shape =Insecticide )) +
geom_point(aes(y = p_Killed, colour="aquamarine", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="p_Killed")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = prob_s, colour="orange", shape =Insecticide )) +
geom_point(aes(y = p_Killed, colour="aquamarine1", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="p_Killed")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = prob_s, colour="orange", shape =Insecticide )) +
geom_point(aes(y = p_Killed, colour="aquamarine2", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="p_Killed")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = prob_s, colour="orange", shape =Insecticide )) +
geom_point(aes(y = p_Killed, colour="aquamarine3", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="p_Killed")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = prob_s, colour="orange", shape =Insecticide )) +
geom_point(aes(y = p_Killed, colour="aquamarine4", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="p_Killed")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = prob_s, colour="orange", shape =Insecticide )) +
geom_point(aes(y = p_Killed, colour="purple", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="p_Killed")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = prob_s, colour="darkorange", shape =Insecticide )) +
geom_point(aes(y = p_Killed, colour="purple", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="p_Killed")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = prob_s, colour="darkorange", shape =Insecticide )) +
geom_point(aes(y = p_Killed, colour="cyan", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="p_Killed")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = prob_s, colour="darkorange", shape =Insecticide )) +
geom_point(aes(y = p_Killed, colour="cadetblue", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="p_Killed")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = prob_s, colour="chocolate1", shape =Insecticide )) +
geom_point(aes(y = p_Killed, colour="cadetblue", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="p_Killed")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = prob_s, colour="chocolate1", shape =Insecticide )) +
geom_point(aes(y = p_Killed, colour="deepskyblue", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="p_Killed")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = prob_s, colour="orange2", shape =Insecticide )) +
geom_point(aes(y = p_Killed, colour="deepskyblue", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="p_Killed")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = prob_s, colour="chocolate1", shape =Insecticide )) +
geom_point(aes(y = p_Killed, colour="deepskyblue", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="p_Killed")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = prob_s, colour="coral", shape =Insecticide )) +
geom_point(aes(y = p_Killed, colour="deepskyblue", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="p_Killed")) + theme_classic()
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = p_Killed, colour="coral", shape =Insecticide )) +
geom_point(aes(y = prob_s, colour="deepskyblue", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="probit")) + theme_classic()
newdata <- data.frame(Insecticide = c("A", "A","A","A", "A","A","B","B", "B", "B","B", "B","C","C", "C", "C","C", "C"), lnD = c(0.6931472, 0.9707789, 1.2470323,1.5238800, 1.8017098, 2.0794415, 0.6931472, 0.9707789, 1.2470323,1.5238800, 1.8017098, 2.0794415, 0.6931472, 0.9707789, 1.2470323,1.5238800, 1.8017098, 2.0794415), lnD2 = c(0.4804530, 0.9424117, 1.5550895,2.32221, 3.246158, 4.32407, 0.4804530, 0.9424117, 1.5550895,2.32221, 3.246158, 4.32407, 0.4804530, 0.9424117, 1.5550895,2.32221, 3.246158, 4.32407) )
newdata$prob_s <- predict(fitprob_s, newdata[,1:3], type = c("response"), se.fit=TRUE)$fit
newdata$Deposit<-exp(newdata$lnD)
kable(newdata)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(stargazer)
library(kableExtra)
datos<-read_csv("https://raw.githubusercontent.com/LeobardoEnriquezH/Data/main/Preg3B.csv", show_col_types = FALSE)
datos$Insecticide<-factor(datos$Insecticide) #declaramos la variable como factor
#Realizamos un relevel para poner como referencia "1"
datos$Insecticide<-relevel(datos$Insecticide,"A")
#Creamos dato de proporcion de insectos que mueren
datos$p_Killed<-datos$Killed/datos$Number
ggplot(data=datos, aes(x=Deposit,y=p_Killed, colour=Insecticide))+ geom_point()+ theme_classic()
#Convertimos a datos desagrupados (más común en la práctica)
#library(tidyverse)
datos$NoKilled<-datos$Number-datos$Killed
datna_1=datos %>% group_by(Killed,Insecticide,Deposit) %>%
do( data.frame(died= rep(1, .$Killed)))
datna_2=datos %>% group_by(Killed,Insecticide,Deposit) %>%
do( data.frame(died= rep(0, .$NoKilled)))
datna<-rbind(datna_1,datna_2)
#Generar variables con datos en logaritmos
datna$lnD=log(datna$Deposit)
#datos$lnD=factor(datos$lnD) #declaramos la variable como factor
#En general hay 4 ligas que se podrían usar para covariables factores: logit, probit, cloglog y log.
#Aqui emplearemos 3 ligas porque tenemos una variable numérica entre las covariables, omitimos liga log.
fitlogit=glm(died~Insecticide*lnD, family = binomial(link="logit"), data=datna)
#summary(fitlogit)
fitprob=glm(died~Insecticide*lnD, family = binomial(link="probit"), data=datna)
#summary(fitprob)
fitcll=glm(died~Insecticide*lnD, family = binomial(link="cloglog"), data=datna)
#summary(fitcll)
#En general hay 4 ligas que se podrían usar para covariables factores: logit, probit, cloglog y log.
#Aqui emplearemos 3 ligas porque tenemos una variable numérica entre las covariables, omitimos liga log.
fitlogit_s=glm(died~Insecticide+lnD, family = binomial(link="logit"), data=datna)
#summary(fitlogit)
fitprob_s=glm(died~Insecticide+lnD, family = binomial(link="probit"), data=datna)
#summary(fitprob)
fitcll_s=glm(died~Insecticide+lnD, family = binomial(link="cloglog"), data=datna)
#summary(fitcll)
#stargazer(fitlogit, fitprob, fitcll, fitlogit_s, fitprob_s, fitcll_s)
#A continuación se muestran los valores AIC y BIC, respectivamente, para las ligas logit, probit y cloglog. Como se mencinó anteriormente, se elige el modelo con el menor AIC, que es el de la liga probit.
#Además con el modelo completo también los criterios AIC y BIC coinciden
# ("AIC:logit probit cloglog")
# c(AIC(fitlogit), AIC(fitprob),  AIC(fitcll))
# ("BIC:logit probit cloglog")
# c(BIC(fitlogit), BIC(fitprob), BIC(fitcll))
#La primera prueba que se debe realizar es
#la similar a la prueba asociada a la tabla ANOVA en regresión lineal múltiple
# library(multcomp)
# K=matrix(c(0,1,0,0,
#            0,0,1,0,
#            0,0,0,1), ncol=4, nrow=3, byrow=TRUE)
# m=c(0,0,0)
# summary(glht(fitprob_s, linfct=K, rhs=m), test=Chisqtest())  #Chisqtest() es apropiada para datos donde y no es continua
# Se rechaza H0, lo que implica que se puede proceder
# al análisis del modelo
datna$lnD2=datna$lnD*datna$lnD
#En general hay 4 ligas que se podrían usar para covariables factores: logit, probit, cloglog y log.
#Aqui emplearemos 3 ligas porque tenemos una variable numérica entre las covariables, omitimos liga log.
fitlogit=glm(died~Insecticide*lnD+Insecticide*lnD2, family = binomial(link="logit"), data=datna)
#summary(fitlogit)
fitprob=glm(died~Insecticide*lnD+Insecticide*lnD2, family = binomial(link="probit"), data=datna)
#summary(fitprob)
fitcll=glm(died~Insecticide*lnD+Insecticide*lnD2, family = binomial(link="cloglog"), data=datna)
#summary(fitcll)
#En general hay 4 ligas que se podrían usar para covariables factores: logit, probit, cloglog y log.
#Aqui emplearemos 3 ligas porque tenemos una variable numérica entre las covariables, omitimos liga log.
fitlogit_s=glm(died~Insecticide+lnD +lnD2, family = binomial(link="logit"), data=datna)
#summary(fitlogit)
fitprob_s=glm(died~Insecticide+lnD +lnD2, family = binomial(link="probit"), data=datna)
#summary(fitprob)
fitcll_s=glm(died~Insecticide+lnD +lnD2, family = binomial(link="cloglog"), data=datna)
#summary(fitcll)
#stargazer(fitlogit, fitprob, fitcll, fitlogit_s, fitprob_s, fitcll_s)
#Además con el modelo completo también los criterios AIC y BIC coinciden
# ("AIC:logit probit cloglog")
# c(AIC(fitlogit), AIC(fitprob),  AIC(fitcll))
# ("BIC:logit probit cloglog")
# c(BIC(fitlogit), BIC(fitprob), BIC(fitcll))
#La primera prueba que se debe realizar es
#la similar a la prueba asociada a la tabla ANOVA en regresión lineal múltiple
# library(multcomp)
# K=matrix(c(0,1,0,0,0,
#            0,0,1,0,0,
#            0,0,0,1,0,
#            0,0,0,0,1), ncol=5, nrow=4, byrow=TRUE)
# m=c(0,0,0,0)
# summary(glht(fitprob_s, linfct=K, rhs=m), test=Chisqtest())  #Chisqtest() es apropiada para datos donde y no es continua
# Se rechaza H0, lo que implica que se puede proceder
# al análisis del modelo
newdata <- data.frame(Insecticide = c("A", "A","A","A", "A","A","B","B", "B", "B","B", "B","C","C", "C", "C","C", "C"), lnD = c(0.6931472, 0.9707789, 1.2470323,1.5238800, 1.8017098, 2.0794415, 0.6931472, 0.9707789, 1.2470323,1.5238800, 1.8017098, 2.0794415, 0.6931472, 0.9707789, 1.2470323,1.5238800, 1.8017098, 2.0794415), lnD2 = c(0.4804530, 0.9424117, 1.5550895,2.32221, 3.246158, 4.32407, 0.4804530, 0.9424117, 1.5550895,2.32221, 3.246158, 4.32407, 0.4804530, 0.9424117, 1.5550895,2.32221, 3.246158, 4.32407) )
newdata$prob_s <- predict(fitprob_s, newdata[,1:3], type = c("response"), se.fit=TRUE)$fit
newdata$Deposit<-exp(newdata$lnD)
kable(newdata)
newdata1<- newdata[,-c(1,5)]
datosfin<-cbind(datos,newdata1)
ggplot(data = datosfin, aes(x = Deposit))+
geom_point(aes(y = p_Killed, colour="coral", shape =Insecticide )) +
geom_point(aes(y = prob_s, colour="deepskyblue", shape = Insecticide)) +
scale_y_continuous(sec.axis = sec_axis(~ .*1,  name="probit")) + theme_classic()
ggplot(data=datos, aes(x=Deposit,y=p_Killed, colour=Insecticide))+ geom_point()+ theme_classic()+
theme(text = element_text(size = 9),element_line(size =1))
ggplot(data=datos, aes(x=Deposit,y=p_Killed, colour=Insecticide))+ geom_point()+ theme_classic()+
theme(text = element_text(size = 9),linewidth(size =1))
ggplot(data=datos, aes(x=Deposit,y=p_Killed, colour=Insecticide))+ geom_point()+ theme_classic()+
theme(text = element_text(size = 9),element_line(size =1))
ggplot(data=datos, aes(x=Deposit,y=p_Killed, colour=Insecticide))+ geom_point()+ theme_classic()+
theme(text = element_text(size = 5),element_line(size =1))
ggplot(data=datos, aes(x=Deposit,y=p_Killed, colour=Insecticide))+ geom_point()+ theme_classic()+
theme(text = element_text(size = 5),element_line(size =2))
ggplot(data=datos, aes(x=Deposit,y=p_Killed, colour=Insecticide))+ geom_point()+ theme_classic()+
theme(text = element_text(size = 5),element_line(size =1))
ggplot(data=datos, aes(x=Deposit,y=p_Killed, colour=Insecticide))+ geom_point()+ theme_classic()+
theme(text = element_text(size = 7),element_line(size =1))
ggplot(data=datos, aes(x=Deposit,y=p_Killed, colour=Insecticide))+ geom_point()+ theme_classic()+
theme(text = element_text(size = 11),element_line(size =1))
ggplot(data=datos, aes(x=Deposit,y=p_Killed, colour=Insecticide))+ geom_point()+ theme_classic()+
theme(text = element_text(size = 11),element_line(size =5))
ggplot(data=datos, aes(x=Deposit,y=p_Killed, colour=Insecticide))+ geom_point()+ theme_classic()+
theme(text = element_text(size = 11),element_line(size =3))
ggplot(data=datos, aes(x=Deposit,y=p_Killed, colour=Insecticide))+ geom_point()+ theme_classic()+
theme(text = element_text(size = 11),element_line(size =0.5))
ggplot(data=datos, aes(x=Deposit,y=p_Killed, colour=Insecticide))+ geom_point()+ theme_classic()+
theme(text = element_text(size = 11),element_line(linewidth =0.5))
ggplot(data=datos, aes(x=Deposit,y=p_Killed, colour=Insecticide))+ geom_point()+ theme_classic()+
theme(text = element_text(size = 11),element_line(linewidth =0.5), weight=12)
ggplot(data=datos, aes(x=Deposit,y=p_Killed, colour=Insecticide))+ geom_point()+ theme_classic()+
theme(text = element_text(size = 11),element_line(linewidth =0.5))+ option(weight, height)
ggplot(data=datos, aes(x=Deposit,y=p_Killed, colour=Insecticide))+ geom_point()+ theme_classic()+
theme(text = element_text(size = 11),element_line(linewidth =0.5))
